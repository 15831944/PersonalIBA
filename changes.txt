**********************************
*            8.4.1. 7          *
**********************************
注：8.4.0.2~8.4.1.6主要增加了本地模式的收银台功能(支持断网时上下机，激活，充值，退款结账功能)，直到8.4.1.7本地版功能已经完善和稳定了。如使用8.4.0.2~8.4.1.6之间版本发生本地模式相关错误，请升级为8.4.1.7及以上版本。
20160325
修改：本地模式下，创建LocalMember记录不需要扣率信息，只有本地模式下登陆终端时才会判断是否有有效扣率信息，没有则不允许登陆
修改：本地模式下，禁用用户视图右键菜单的“上机”和“重新计费”功能，置灰快捷栏的“修改密码”，“充值退款”按键
修改：本地模式下，用户余额显示保留两位小数，不做四舍五入
修改：修改密码提示框不限输入长度，只有当点击“确认后”，才根据是否超过8位弹出提示
修复：去除代码中几乎所有try catch(...)块，这些语句并没有对异常做出处理，同时因为在vs2003中，即便采用/EHsc，try块仍然会捕捉结构化异常，会导致所有可能的结构化异常被隐藏和忽略，一旦出现崩溃也无法查找到源头原因
修复：闲事包月时策略列表显示的策略与列名不匹配
20160305
增加：好旺宝微信充值功能。充值以及充值退款界面增加微信充值，点击后将在好旺宝上显示出二维码。
修改：结账时用户不在线，将直接从用户视图删除用户
增加：异常崩溃时，自动发送崩溃反馈邮件
2016-0304
修复：IBA登陆窗口有时不置顶
修复：收银台设置“用户试图按下回车键后：选择不弹出任何界面”但是还是会弹出结账退款界面
修复：用户开户有直接选择包时，未上机直接结账后显示的退款金额不正确
2016-0302
修改：注册窗口自动生成账号时，默认的证件类型固定为“其他证件”--孙成龙新需求
增加：提前包时增加“说明：不选择包时区域时，默认按设置的时间端提前包时。”--孙成龙新需求
2016-0301
修改：充值窗口在用户未激活时仍显示取消激活，包时和结账链接
增加：2016年2月18日起运行该版本，将自动清理一次本地库中本地模式相关记录
修改：机器视图中选中终端，将设置当前用户为该终端上的用户(即点击其他窗口时自动设置账号为该用户账号)---孙成龙新需求
修复：换机时，终端自动开机后不自动登陆
修改：点击操作日志栏，只要是弹出窗口的，就将当前用户设置为该日志的用户--孙成龙新需求
修复：刷卡信息输出栏未显示用户账户余额和积分信息
修复：回乡证无法激活的问题
修复：后台不允许便捷通道激活的情况下，充值框没有通往结账和包时的便捷按钮
2015-1224
增加：进入本地模式前弹出选择框，可选择继续重试或者进入本地模式。进入本地模式前，弹出提示框。
2015-1218
删除：网盾实名开启注册窗口的电话号码按钮
2015-1223
修改：本地模式的切换流程更改。a.只在向中心请求时检查网络状态b.请求中心失败时，尝试连接网络1分钟才进入本地模式
修复：与UDO连接建立更改到IBA登陆之后进行。该问题会导致"机器试图显示“余额不足或终端锁屏”，但是用户试图正常"的异常。
2015-1214
变更：注册用户后再点击修改密码，默认显示刚才注册的用户的账号
变更：便捷通道输入已激活的用户的后几位弹出窗口时，视图保持不变
2015-1208
增加：根据后台参数gintHideTelInput决定是否隐藏开户时的电话输入框
2015-1205
删除：应孙珂要求，删除激活后发送实名下机信息
2015-1202
增加：创建表OccupySeat，用于微信占座位功能
2015-1130
修复：提前包时对话框经多次排序后，显示区域信息错误
修改：关于对话框公司名称修改为：深圳市嘟嘟牛科技有限公司
2015-1126
增加：标题栏增加显示 - 24小时售后客服：4006683755
修改：关于对话框的公司信息变更
2015-1126
增加：激活完成后，如果为金桥实名，则向金桥实名上传用户信息
2015-1125
增加：提前包时-选取包时区域-改为仅显示后台设置允许的区域
2015-1124
修复：UDO本地登录时有可能穿回小写的终端号，因此判断是否在线改为不区分大小写
修复：提前包时显示剩余金额，提前包时所需金额修正
2015-1119
修复：上下班对话框不显示时间
修改：结账对话框，Balance返回的用户级别为1显示为普通用户，其他显示为会员用户
2015-1106
修改：本地模式恢复到正常模式后的上报流程：
	在线用户从本地模式恢复到正常模式后的流程：
		中心模式下激活，中心模式下登陆UDO的会员 -  CheckOut + Activate + CheckCard&DaBalance
		中心模式下激活，中心模式下登陆UDO的临时用户 -  CheckCard&DaBalance
		中心模式下激活，本地模式下登陆UDO的会员 - BuckleAmount + CheckCard&DaBalance
		本地模式下激活，本地模式下登陆UDO的会员 - BuckleAmount + CheckCard&DaBalance
		中心模式下激活，本地模式下登陆UDO的临时用户 - BuckleAmount + Activate + CheckCard&DaBalance
	在线用户从本地模式恢复到正常模式后的流程： 
		未结账，中心模式下激活 - IDCheckCard + DoBalance
		未结账，本地模式下激活 - Activation + IDCheckCard + DoBalance
		已结账，中心模式下登陆UDO，会员 -  checkout2
		已结账，中心模式下登陆UDO，临时用户 -  IDCheckCard + Deregister
		已结账，本地模式下登陆UDO，会员 - DoBuckleAmount + (如是中心激活)Activation(取消激活)
		已结账，本地模式下登陆UDO，临时用户 - DoBuckleAmount + Deregister	 
2015-1102
修改：取消 - 本地模式数据未完成上报中心前禁止使用上下班按钮改为可点击上下班按钮但弹出提示框
2015-1027
修复：实名刷卡，增加判断是否断网
2015-1026
修复：完善便捷通道所有功能
修复：临时用户结账时消费日志栏不显示内容
2015-1022
修改：为解决闪退 - 1.工作线程中删除更新窗口变量(几率造成闪退)
		   2.删除工具栏的当前账号显示和更新
2015-1015
修改：退款窗显示，VIP会员显示：会员卡结账，临时用户显示：普通卡结账
2015-1016
修改：退款窗显示，VIP会员或后台设置不可退款时，显示"余额："，可以退款时显示"实退："
2015-09-30
修改：本地模式下界面显示50整数倍金额
2015-09-11
修改：场景视图和状态图的图片模板
修复：点击充值卡充值会弹出充值界面
2015-08-27
功能增加：用户管理-收银台包时-提前包时
2015-08-26
1.添加场景视图功能
2.更改打印小票字体
3.状态栏增加显示各区域剩余电脑情况
4.收银台包时用户查询后的结果列表实现排序
**********************************
*            8.4.0.1         *
**********************************
1.注释DoReport(MachReport)上报
2.去除内部测试提示
**********************************
*            8.4.0.1            *
**********************************
初始版本
**********************************
*            8.3.0.9            *
**********************************
2015-7-21
	1.CComputerList::DoReport函数直接返回TRUE,注释原有操作，以确定线上网络状态反复跳动的原因

**********************************
*            8.3.0.9            *
**********************************
2015-3-17
	1.增加CComputerList上报客户端信息

**********************************
*            8.3.0.8            *
**********************************
2015-1-7
	1. 针对过滤王做特殊更改，刷卡信息的证件号码前有FN前缀， 表示指纹识别得到的信息。
	   把开户和激活接口的扣点类型设置为1（dataType参数）
	2. 把8209过滤王IBA特殊版本也做了和功能1相同的更改.

**********************************
*            8.3.0.7            *
**********************************
2015-1-2
	1. 过滤王刷卡，无姓名的随机生成姓名，允许开户激活。


**********************************
*            8.3.0.5            *
**********************************
2014-11-17
	使用IBA新的A4打印交班报表动态库DdnReport.dll，内容增加微信充值金额。(需配合1.0.0.2版本的IBARes.dll动态库，放在IBAbin目录下，2.0.0.1版本，原来是放在IBAReport目录下)
	IBARes.dll增加用于打印的ReportTemplate.html文件。

**********************************
*            8.3.0.4            *
**********************************
2014-11-12
	1.增加传递扣点的类型值（固定身份证）
**********************************
*            8.3.0.3            *
**********************************
2014-11-6
	1.合并主版本和智多金桥实名版本
	2.去掉原来合并进来的SunlikeAuditProxy.exe的代码
	3.移植国外计费场景视图的功能
	4.增加IBARes.dll动态库作为资源动态库
	5.开户时候的性别根据身份证自己计算性别（只是更改显示，原来往中心传递的数据已经做了计算的操作）
**********************************
*            8.3.0.2            *
**********************************
2014-11-5 
	1.打印小票增加打印微信充值金额
2014-11-3 
	1.登录成功后获取微信相关数据，从十秒后获取改为登录后立即获取（线程进行），查询网吧是否开通400也移到线程完成	
	2.上下班信息界面，增加“微信充值金额”信息，默认隐藏，开启后显示。
**********************************
*            8.3.0.1            *
**********************************
2014-10-21
	1.收银台配置gintcnqconsume=1时，收银台进行“用户消费查询”和“终端消费查询”时，不响应“查询”按钮点击。
	2.收银台设置增加一个删除数据页面，可以设置开始时间和结束时间，删除用户消息历史。
**********************************
*            8.3.0.0            *
**********************************
2014-10-10
	1.所有检查（CheckCard）卡的操作，若传递的账号不满10位，则自动在前面补零。
2014-10-9
	1.将微信版本功能合并到主版本
**********************************
*            8.2.9.71            *
**********************************
2014-8-25
	1.8.2.7.0版本中“1.IBA登录10秒以后将WK系统参数的版本管理地址写入数据库表Systemconfig”修改到线程里面执行，同时增加查询微信中间件地址，并将地址写入数据库。
**********************************
*            8.2.9.9            *
**********************************
2014-9-16
	1.增加一个参数"gintcardreturn"设置等于1时只有刷卡才能进行结账退款操作。
2014-8-15
	1.连接中心相关的网络操作，切换中心时，也修改数据库的地址，保证数据库中能连通的地址始终是主中心地址。
2014-8-5 // 暂时取消
	1.登录接口增加传递机器名，最大15位，超过15位截取前面15位。
**********************************
*            8.2.9.8             *
**********************************
2014-8-13
	1.激活和开户时，都自动覆盖照片。
**********************************
*            8.2.9.7             *
**********************************
2014-7-31
	1.去掉日志加密（有可能到导致IBA激活等操作卡的原因）
**********************************
*            8.2.9.6             *
**********************************
2014-7-28
	1.结束SunlikeAuditProxy.exe进程时，增加等待进程退出时间，最长3秒。
---------SunlikeAudit.dll--changes---------
2014-7-29
	1.长沙任子行上下机不上传"管理员"的信息，之前是比较当前姓名与"管理员"比较，大于等于0就不上传;修改为相等才不上传。
**********************************
*            8.2.9.5             *
**********************************
2014-7-23
	1.修改摄像头名字和设备对应不上的问题。
	2.若配置了"gintauditinterface=1"，启动时，删除希之光实名接口的启动项，同时关闭SunlikeAuditProxy.exe进程。
**********************************
*            8.2.9.4             *
**********************************
2014-7-22
	1.程序启动和退出时，增加调用SunlikeAudit动态库的代码。
	2."gintauditinterface=1"要求调用SunlikeAudit.dll动态库，调用失败则退出；默认不调用。
	3.在虚拟机环境下，点卡平台按钮变灰，不能使用，若中心配置“gintenablvirtualrun=1”，则虚拟机环境下也可调用点卡平台。（支持判断Vmware虚拟机和Virtual PC虚拟机）
	4.只允许打开一个开户对话框。

---------SunlikeAudit.dll--changes---------
2014-7-22
	1.SunlikeAudit.dll动态库，由SunlikeAuditProxy.exe 2.2.2.9版本修改成动态库版本，初始化版本。
	2.三次查找不到rzxsurename.exe，会弹出对话框提醒，用户点确定后再退出程序。

**********************************
*            8.2.9.3             *
**********************************
2014-7-16
	1.激活的时候增加一个判断，若中心的三个参数（发证机关，住址，民族）有一个为空，且本地（读卡器或扫描仪传递的数据）的三个参数都不为空才向中心修改数据。
**********************************
*            8.2.9.2             *
**********************************
2014-7-10
	1.读取和拍照所在文件夹先从sfreg的配置文件读取，若配置文件不存在，则在IBABin目录下生成Image文件夹和Zc、Zj两个子文件夹）
	2.激活和开户的时候拷贝ID.jpg（扫描和激活的时候生成的照片）到相应的目录，并删除ID.jpg。同时拷贝一个ID_bak.jpg,方便后续查看最后生成的证件照是哪一个。
**********************************
*            8.2.9.1             *
**********************************
2014-06-30
	1.激活界面也增加按照功能，ginsoftsfreg的参数作用同开户一样。
	2.开户界面增加一个读取证件按钮，点击扫描证件按钮弹出的菜单去除"读取二代证".
2014-06-26
	1.收银台开户界面增加拍照功能，拍照按钮ginsoftsfreg=1的时候显示，=2的时候强制拍照。照片生成再IBABin目录下，生成Image子目录，再创建两个自文件夹，ZC存放注册照，ZJ存放证件照。
**********************************
*            8.2.9.0             *
**********************************
2014-06-20
	1.增加智多实名相关处理。（在中心不配置实名的情况下，在[IBA]段下添加AuditType=12）
	2.移植SunlikeAudtiInterface上机的相关功能到IBA。
**********************************
*            8.2.8.9             *
**********************************
2014-06-13
	1.取得客户端结账消息的时候，若NetBar.exe程序存在(恒信收银台进程名，第一次结账的时候做一次判断)，就将结账的终端号移除非数字部分，然后向恒信收银台发送结账消息。
**********************************
*            8.2.8.8             *
**********************************
2014-06-10
	1.网盾实名增加传递注册终端数，IP和MAC地址，计费截止日期。
**********************************
*            8.2.8.7             *
**********************************
2014-05-23
	1.激活时，若中心开机400验证或中心配置了gintshenzhen不为0，就像实名接口发送注册信息（开启一个线程）。
	2.开户时，若中心ID为1，向实名接口发送注册信息。（不通过SFREG.exe）
	3.隐藏，激活界面和开户界面的实名注册按钮。
	4.修改用户资料时，用户资料输入一个不存在的用户，会让部分编辑框不能编辑，即使再输入正确的用户号，也不能编辑的问题。
**********************************
*            8.2.8.6             *
**********************************
2014-05-15
	1.增加金桥实名的处理，开户时候会会想实名接口程序发送注册消息，需要auditinterface.dll动态库支持。
	2.创建实名处理时先做下判断，若中心没有配置实名，就从IBA.ini文件的[IBA]段下读取AuditTyp项的值作为实名类型。
**********************************
*            8.2.8.5             *
**********************************
2014-05-08
	1.激活时，没有手机号码弹出修改资料对话框，修改完资料后自动弹出sfreg.exe。
**********************************
*            8.2.8.4             *
**********************************
2014-04-29
	1.修改登录接口，不上传sfreg.exe版本号
**********************************
*            8.2.8.3             *
**********************************
2014-04-29
	1.增加sfreg.exe版本上报(没有有sfreg.exe按照原来的方式上传版本，有sfreg.exe在原来的版本号加逗号，再加sfreg.exe版本号。)
**********************************
*            8.2.8.2             *
**********************************
2014-04-09
	1.解决断网后没有办法打开收银台的问题.(修改原来"获取版本管理地址和获取400设置"是在收银台打开后就去获取的问题,修改为登录后获取,断网模式下不获取)
	2.建议对收银台获取400配置、获取版本管理地址功能以及能否正常进入断网模式进行测试。
2014-04-08
	1.解决报winhttp.dll错误的问题
	2.日志加密(密码dodonew)
**********************************
*            8.2.8.1             *
**********************************
2014-04-02
	1.去掉8.2.7.9异常捕获处理(有可能报winhttp.dll错误的原因)
**********************************
*            8.2.8.0             *
**********************************
2014-3-28
	1.暂时去掉8.2.7.6版本修复的问题的代码.
	2.增加扫描二代证背面和扫描护照选项(需要搭配2.0.0.8版本的ScanReco.dll动态库)
	3.判断如果选择的是快证通扫描仪则程序运行期间只初始化一次.
**********************************
*            8.2.7.9             *
**********************************
2014-3-18
	1.开户界面增加查询手机号码按钮.
2014-3-14
	1.对开户和查询余额,检查操作,做捕获异常处理。
	2.程序栈的大小由1MB改为10MB。
**********************************
*            8.2.7.8             *
**********************************
2014-2-28
	1.增加对中心参数gintcannotuserupgrade的处理,非0时禁用用户升级.
	2.增加对中心参数gintonlyonlineuser的处理,非0时只显示在线用户
	3.上下班设置增加设置固定预留金.
	4.激活时候需要弹出修改资料对话框时,直接传递检查卡时查询到的用户信息,不再查询.
**********************************
*            8.2.7.7             *
**********************************
2014-2-27
	1.解决收银台结账客户端不会马上锁屏的问题.
	2.修改传递给sfreg.exe的信息
	3.修改激活和修改用户资料不再查询memberinfo接口,改为从balance接口获取手机号码等信息.
**********************************
*            8.2.7.6             *
**********************************
2014-1-16 
	1.解决包时结束后转正常计费，余额不足结账锁屏后，机器视图和用户视图终端信息不刷新的问题。
**********************************
*            8.2.7.5             *
**********************************
2013-12-20
	1.解决自动读卡以后实名注册没有照片的问题。（还有新的ID2Reader.exe自动读卡程序）
	2.解决华视扫描照片慢的问题。
2013-12-31
	3.激活的前做下判断，如果设置是任子行实名或需要400验证，则先向中心查询一次用户详细资料。
		1）若设置的是任子行实名，判断地址、民族、发证机关、有任意一个和刷卡传递的信息和中心的信息不相等，则进行修改并写入数据库。
		2）若中心设置了400绑定（或绑定并验证）且查询到手机号码为空，则弹出修改用户资料框让收银员修改手机号码。
**********************************
*            8.2.7.4            *
**********************************
2013-12-31
	1.若中心设置了400验证400绑定（或绑定并验证），则开户和修改资料增加手机号码编辑框，并验证手机号码合法性（13位并且不能有字母，不能为空）。
	2.解决充值金额为2.3/4.1/4.6/5.1/8.2/8.7/9.2/9.7元的时候，充值结果少一分的问题。建议对充值和充值修正进行测试。
	3.修改资料对话框打开的时候如果设置是任子行实名或需要400验证，则先向中心查询一次用户详细资料。点击修改资料的时候将民族、发卡地址、详细地址、手机写入修改资料（原来的修改资料会把民族，发卡地址、详细地址、手机号清空）
	4.开户和修改资料的时候将手机号码写入数据库。
**********************************
*            8.2.7.3             *
**********************************
2013-12-06
	1.身份证自动匹配功能对所有实名（包括非实名）可用
	2.解决充值界面有部分证件照显示成黑色的问题。
**********************************
*            8.2.7.2             *
**********************************
2013-12-03
	1.解决实名注册拍照崩溃的问题。
	2.新网盾实名接口匹配。
	3.解决只要账号名字头几位和网吧老板账号一样的时候会获得老板权限的问题。
**********************************
*            8.2.7.1             *
**********************************
2013-11-21
	1.WK增加自定包时参数gintcannotselfbt等于0可以自定义包时，反之不行。默认等于0
	2.WK增加开户A4打印方式。gintisprinta4等于0是POS机方式，等于1是A4方式。
gintenablselfbt=0;;
**********************************
*            8.2.7.0             *
**********************************
2013-11-14
	1.WK设置gintDisallowUnlock=2是，机器视图右键菜单，“解屏维护”不可用
	2.在IBA.INI的IBA字段下，设置子项CanNotTermConsumeQuery=1则不允许终端消费查询。
2013-11-11
	1.IBA登录10秒以后将WK系统参数的版本管理地址写入数据库表Systemconfig
**********************************
*            8.2.6.9             *
**********************************
2013-11-08
	1.激活成功时将从中心查询到的数据，开户时的数据写入数据库member表
	2.开户保存身份证地址信息。
**********************************
*            8.2.6.8             *
**********************************
2013-11-05
	1.在收银台设置的上下班选项中增加“不显示交接班按钮“选项。
2013-10-29
	1.充值界面显示证件和注册照gintsoftsfreg参数值不为0.
	2.增加网吧公告栏。
	3.增加控制参数gintAccount12(0不启用，为1时候截取证件号（身份证或者二代证）的后12位为上网账号)
**********************************
*            8.2.6.7             *
**********************************
2013-10-11
	1.加入网吧控制参数gintsoftsfreg参数(0:不使用SFREG(缺省)
1:手动调用SFREG，收银台开户、充值界面分别放置"实名注册"按钮2:开户后自动调用SFREG)
	2.调用sfreg.exe时向其传递开户用的参数，接受sfreg.exe验证通过的消息，并开户。
2013-9-22
	1.开户增加聚宝验证。
加入网吧控制参数: gintEnableJuBao=1, 如果为1，允许开户界面的账号和姓名可编辑， 开户界面中增加拍照按钮， 调用聚宝接口进行照片比对，
比对通过允许开户，否则不允许开户。如果是刷卡或者扫描过来的，就不需要比对,也不需要拍照。
2.将增收宝滚动信息的内容中的网吧2字修改为 门店，同时删除“5. 增收宝即赚提成也赚上网费，一举两得”


**********************************
*            8.2.6.6             *
**********************************
2013-8-30
	1、8.2.6.4版本的任子行照片路径有误，重新修改
**********************************
*            8.2.6.6             *
**********************************
2014-12-15
	1、任子行荣联上网账号改成证件号


**********************************
*            8.2.6.5             *
**********************************
2013-8-2
	1、如果是网盾实名，开户扫描证件去除“扫描其它证件”选项
**********************************
*            8.2.6.4             *
**********************************
2013-7-26
	1、中心增加参数gintrzxphoto控制（gintrzxphoto=1,显示，0默认不显示
），此参数控制是否显示任子行照片。在获取gintrzxphoto 的值为1且是二代证刷卡的时候，会从注册表HKEY_LOCAL_MACHINE\SOFTWARE\RzxCorp\SureName读取ExePath的值 + “\\” + “photo.bmp”取为实名照片的地址，把他复制到IBA工作目录的UserImages文件夹下，并以账号为文件名。
	2、禁止账户包时判断。（中心返回1是允许账户包时,中心返回0是禁止账户包时,
中心返回2是只允许临时用户包时）
	3、增加任子行实名密码功能
**********************************
*            8.2.6.3             *
**********************************
2013-6-27
	1、中心配置参数控制（gintMobileOpen=1 开启,为0不启用），此参数控制IBA开户界面的账号输入框为空，需收银员自己输入手机号码开户，程序控制账号第一位为1，长度为11位属于手机号。
	2、中心门店控制设置开启‘身份证唯一’的设置，实名下杜绝一张身份证开多个手机号的问题。

2013-6-14
	1.收银台定时1小时判断日志文件是否24小时未重新登入，超过24小时自动发checkin报文至中心，判断中心参数（gstrForceQuit=IBA8248_1，等于1	判断版本强制退出，0不处理），弹出相应提示，确定后强制退出并自动运行IBA.exe程序。
	2、弹出框提示：“相关部门升级要求，收银台将在确定后退出完成升级"
2013-6-17
	1.登录的时程序当前版本小于中心要求版本则弹出对话框提示
**********************************
*            8.2.6.2             *
**********************************
2013-6-7
	1.网盾老用户激活的时候也发消息给SunlikeAuditProxy要求上传照片
**********************************
*            8.2.6.1             *
**********************************
2013-5-20
	1.接收IServer的数据包大小增加了一倍
**********************************
*            8.2.6.0             *
**********************************
2013-5-6
以下改动全部是针对任子行实名的。在测试环境域ID=99， 生产环境必须为ID=4， 江门地区
	1. 当IDCardType=1时认为是会员用户， =3认为是临时用户.
	2. 如果开卡时是临时用户， 隐藏掉开户界面的会员单选框， 并强制性选中临时卡。
	3. 如果是临时用户， 将用户升级界面的升级按钮变灰。并在升级按钮的处理事件中判断是否允许升级.	

**********************************
*            8.2.5.8             *
**********************************
2013-3-21
	1.暂时屏蔽ID2Reader.exe版的用户信息图片显示功能
2013-3-20 
	1.当中心返回的参数=gintidentitycard=18时，在开户的时候就对用户年龄进行验证。=0不验证。
2013-3-13
	1.如果是网盾实名则在开户的时候判断IBA所在目录的SunlikeAuditProxy的配置文件里面是否有一个配置的是网盾实名中心
2013-3-8 
	1.在日志工具栏里，用户自己结账下机不是收银台操作结账的时候，“结账记录”这个选项卡也能接收到信息。
	2.“结账记录”添加右键“导出到Excel”功能，并且屏蔽自带的右键菜单。
	3.在日志IBA.ini下的[IBA]字段添加[IsShowShiftCash]项，=1的时候显示"查询统计"菜单下的"收银员交款查询"，反之则不显示。
**********************************
*            8.2.5.7             *
**********************************
2013-1-28
	1.增加ID2Reader.exe版的用户信息图片显示功能。在用户视图左边的任务界面中展示图片，图片存于本地IDImages目录下。

**********************************
*            8.2.5.6             *
**********************************
2013-1-14
	1.修改开户后，IBA处于最顶层的bug, ID2Reader.exe读卡间隔500ms/次.

**********************************
*            8.2.5.5             *
**********************************
2013-1-14
	1.CIBAConfig对象负责配置文件的加载和保存， 8.2.5.4版本中的问题的原因是配置文件没有被加载，在对象销毁时，却做了保存
          导致配置文件内容被重置。代码中添加标志，如果加载了，那么对象销毁时做保存操作。

**********************************
*            8.2.5.4             *
**********************************
2013-1-11
	1.在投版本的情况下，连续双击IBA.exe会出现崩溃，配置文件被重置。

**********************************
*            8.2.5.3             *
**********************************
2013-1-5
	1. IBA为ID2Reader创建认证信息, ID2Reader启动时，如果没有发现认证信息，就自动关闭。
	2. 中心增加参数gintID2Reader=1来启用ID2Reader程序。
	3. ID2Reader.exe必须和IBA.exe位于同一目录下。

**********************************
*            8.2.5.2             *
**********************************
2013-1-4
	1. 增加外挂式自动读卡工具ID2Reader.exe, 在后台运行。
	2. IBA启动时，带起ID2Reader.exe。
	3. IBA退出时，关闭ID2Reader.exe。
	4. 需使用ScanReco.dll 2.0.0.5版本以上。
	

**********************************
*            8.2.5.1             *
**********************************
2012-12-28
	1. 增加Ctrl+Q快速读卡功能。

**********************************
*            8.2.5.0             *
**********************************
2012-11-15
	1. 修改2012-11-12的第一条，只有当收银台ID为1时才判断。

2012-11-12
	1. 判断中心控制参数gintrzxmonitoring=1时，监控代理程序是否已启动，并且判断是否在IBABin目录下启动的代理程序。
           如果没有正确启动，那么做提示，并且不允许开户。

**********************************
*            8.2.4.8             *
**********************************
2012-8-15
	1. 生成点卡动态库DdnPcp.dll 2006版本， 修改界面引入G2XUI库，解决点卡界面卡的问题。

2012-8-10
	1. 收银员登录接口，增加时间戳和hash值（时间戳+密码+文件hash值）字段给中心，增加安全性。


**********************************
*            8.2.4.7             *
**********************************
2012-7-4
	1. 过滤王刷卡的信息进行验证,计算校验码(校验码=卡号+时间戳+密钥 的MD5值)是否和代理程序发送的信息的校验码相同，如果不相同，证明信息被篡改，不允许开户。同时验证时间戳，如果和当前时间相差5分钟以上，认为刷卡超时，

**********************************
*            8.2.4.6             *
**********************************
2012-7-5
	1. 结账界面添加“取消激活”功能。

2012-6-28
	1. 收银台设置里，添加“禁用远程截屏”的配置，默认不选择。当禁用时，截屏需要输入管理员密码。

	2. 在强制扫描的情况下，也验证身份证号码的有效性。

**********************************
*            8.2.4.5             *
**********************************
2012-6-1
	1. 当在线用户表中有用户在中心被销户后，再次在收银台开户，用户视图出现2条相同记录的bug
	
	2  修改在应急模式下，过滤王刷卡，弹出2次开户界面的问题。

**********************************
*            8.2.4.3             *
**********************************
2012-5-16
	1. 修改网盾实名，用手机开户出现“请先刷实名卡或者扫描证件”的问题。

2012-5-16
	1. 在网盾的实名下，开户界面增加"手机号码"按钮，支持手机号码开户。
           证件号码自动填入手机号码，姓名填入“手机号码”。

	2. 增加热键“Ctrl+Q”,自动弹出手机号码的开户界面。

	3. 修改在开其他证件开户时，不传证件照的问题。

**********************************
*            8.2.4.2             *
**********************************
2012-4-23
	1. 修改在增加结账记录的列表显示后，查询消费记录时，然而激活的界面却是结账记录。

	2. 修改在开户输入金额的控制，不能超过10000元。

	3. 修改商品销售里的选择商品对话框中的商品列表在使用“向下箭头”时，按钮不是可用的问题。

	4. 修改在强制扫描的情况下，开户时，验证界面上的开户信息是否和扫描或刷卡而来的数据相符。不相符，
则不允许开户。

2012-4-20
	1. 修改在应急模式下，开户界面中允许输入上网账号，姓名，证件号码

**********************************
*            8.2.4.1             *
**********************************
注: 8240版本号不好，直接跳过

2012-4-9
	1. 在恒信实名下，修改“客户端设置->基本设置”的“结账后客户端”的处理动作，
           如果动作为“重启 或 关机”，那么动作就保持不变。
           如果动作为“锁屏”，那么动作就改成重启，将配置保存到数据库。
           同时把下拉框中的“锁屏”项删除。

**********************************
*            8.2.3.9             *
**********************************
瑞金特殊版本
请参考: IBA特殊版本说明.doc

**********************************
*            8.2.3.8             *
**********************************
2012-3-21
	1. 如果后台配置的实名密码类型gintGlwPassword=4,那么:
            1) 把用户视图右键菜单中的“上机”命令隐藏掉。
	    2) 把开户界面中的选择机器的下拉框隐藏掉

	2. 在网盾的实名下，不检查收银台ID不等于1的网盾的监控。
	
2012-3-20
	1. DdnPcp.dll2.0.0.5版本兼容老收银条版本

	2. 在收银台设置->充值退款 界面中添加“每笔充值的最大金额”的配置,当配置为0时，
	   则不做充值最大金额的限制。
           1) 在开户界面添加控制
           2) 在充值界面添加控制
           3) 在充值退款界面添加控制
           4) 在快速通道输入“+上网账号 金额”时，添加控制

**********************************
*            8.2.3.7             *
**********************************
2012-2-9
	1. 给DdnPcp.dll传的中心地址参数设为: 先主地址，再备中心地址。
        2. DdnPcp.dll 先连主中心，如果主中心连不同，那么再连备中心地址。

**********************************
*            8.2.3.6             *
**********************************
2011-12-28
        1. 开户未消费记录视图: 屏蔽掉开始时间和结束时间,删除列表中的消费类型和用户号，增加备注列。
           数据以用户视图为准。

        2. 更新DdnPcp.dll-2002,修改DdnPcp.dll内存泄露问题(不影响功能)。

2011-12-26
	1. 屏蔽掉收银台设置-监控颜色-重点用户、黑名单选项。

2011-12-21
	1. 修改交接班的pos小票打印时，班次收入计算结果等于现金总额的bug。
           班次收入的打印结果为交接班界面上的班次收入的文本内容。


**********************************
*            8.2.3.5             *
**********************************

2011-12-12
	1. 收银台设置增加“禁止用户视图右键上机功能”的复选框。
	   如果是禁用的，用户视图弹出右键菜单时，上机命令变灰。

	2. 修改关于对话框的版本的显示。例如：
	   嘟嘟牛收银台 8.2
           Bulid：35 Time:2011-12-12 14:46:34

**********************************
*            8.2.3.3             *
*            8.2.3.2             *
*            8.2.3.1             *
*                                *
* 支持现金购买点卡, 需要         *
* DDNPcp.dll 2.0.0.1以上版本支持 *
**********************************
2011-12-7
        1. 自动退款，结账时发送实名下机信息给IServer。

2011-11-30
   合并8211版本的过滤王刷卡、免刷等功能到8231
	1. 发实名下机信息给IServer.
	2. 如果网吧实名为过滤王,那么IBA只接收Proxy发送过来的刷卡信息。禁止过滤王实名下的免刷
	3. 开户成功后，OpenUser返回1； 激活成功后，OpenUser返回1； 其他情况OpenUser返回0

2011-11-22
	1. 问题:累计封顶和足额预扣包时的用户，开通包时后上机失败，并且余额为0，中心查余额不在线,导致用户被自动退款。
   	   解决方案: 累计封顶用户在这种情况下可以自动退掉， 足额预扣用户不做自动退款。

2011-11-21
	1. 打开增收宝时，传入参数“收银员密码”为明文有安全隐患，改成MD5加密后传入。

2011-11-20 
	1. 工具栏中的点卡销售功能保持和以前版本一致.
	2. 在IBA收到客户端发送的现金购买点卡的请求后，IBA通知DDNPcp.dll弹出Tip，
	   点击查看后进入现金点卡销售页面。
	3. 点卡销售成功后，DDNPcp.dll通知IBA处理结果，IBA在通知对应的客户端。

2011-11-18
	1. 修改当账号金额>1000.00元时，结账界面余额显示为空的bug。


**********************************
*            8.2.3.0             *
**********************************

2011-11-16
	1. 实名监控程序的启动。

2011-11-09
	1. 添加 商品退货、积分兑换商品、赠送商品的权限控制。
	   没有权限时，弹出管理员密码输入框。

2011-11-07
	1. 修改包房没钱自动结账后，副账号有钱却被清除的bug。 把有钱的副账号的用户视图里的备注显示为:“包房已经结账，等待退款”
	2. 主菜单->常用工具->锁屏 改为：“电脑锁”。

2011-11-04
	1. 修改包房结账后，副账号如果有钱却被清除的bug。需要IServer3301版本以上。

2011-11-03
	1. 添加包房的自动包房结账功能。
		1) 主账号没钱了。
		2) 主账号本地不在线了。 
		3) 等待2分钟，向中心查一次余额，得到主账号的正常登出时间。查余额时，如果账号是离线状态，那么就可以进行自动结账。
		4) 等到时间到达正常登出时间后，进行自动包房结账。
		5) 包房结账后，通知所有的副账号锁屏(IBA给UDO发送的是换机命令), 但是机器视图并没有清除，需要IServer更改。
		   如果副账号是临时用户并且有钱，那么不做退款，不清用户视图。

2011-10-31
	1. 包房管理界面的包房信息列表控件的后面添加一列:“结账”, 如果包房为未开通,那么“结账”按钮将隐藏。
		1) 点击“结账”， 调用RoomCheckOut中心接口，“已开通”按钮将变成“开通”，并且按钮变灰不可用。
		   如果结账的用户是当前的查询用户（点击查询查到的用户）,那么当前的当前的查询用户的信息都会清空。

		2) 结账后，让本包房内的所有在线用户下机。
		   如果副账号为会员用户并且有包时状态，那么会员用户不从用户视图清掉，没有包时状态就做清除。
		   如果副账号为临时用户并且有包时状态或者有余额，那么临时用户不从用户清掉，没有包时状态或者余额就做清除。

		3) 结账后，如果包房的主账号为临时用户并且有钱，那么弹出结账对话框。

		4) 结账成功后，包房信息列表被刷新。  

	   注：副账号是临时用户，并且有钱，做包房结账后，这个账号变成普通账号，结账时与正常流程一样。


2011-10-26
	1. 添加收银台锁屏功能, 主菜单->常用工具->锁屏
   	  注：需要lock.exe和IBA.exe在同一目录
          需要WIN2003和WIN7里测试。

	2. 添加NetbarRoomInfo接口，获取网吧的包房信息列表

	3. 添加RoomCheckIn接口，为指定账号开通包房

	4. 添加RoomCheckOut接口，包房结账

	5. 结账时，IBA判断对应的账号是否为包房主账号，如果为包房主账号，那么分一下2中情况:
  		1) 主账号临时用户, 结账按钮的名称改为：“包房退款”,窗口的标题也显示为这个文字
  		2) 主账号为会员用户，结账按钮的名称为：“包房结账”,窗口的标题也显示为这个文字
  	注：如果包房里的账户为临时用户，那么IBA还要额外的电泳退款接口，做退款动作。

2011-10-25
	1. 添加包房管理菜单项, 主菜单->用户管理->包房管理.
	   点击弹出包房管理对话框, 列表显示所有的包房信息。对于数输入的账户，必须点击查询后，才能开通指定的包房。

2011-10-24
	1. 主中心连接不通， IBA8200已上版本都会崩溃的问题。 
	   因为加入断网功能后，在更新状态时，即更新快速通道的最右边的状态显示时，导致程序崩溃。

2011-10-21
	1. 场景视图增加右键 弹出机器视图里的菜单. 需要选中 主菜单->常用工具->座位操作->机器菜单。
		原理：当在场景视图选择某个终端时，选中机器视图里对应的终端, 弹出的菜单的父视图设置机器视图，菜单的响应就有机器视图来完成，
		保持功能一致。

	2. 添加结账记录标签， 位于 操作日志，刷卡日志的右边。
		1) 结账界面退款结账
		2) 充值退款界面的退款结账
		3) 自动退款

2011-10-20
	1. 收银台设置->语音设置:添加“自动退款时是否报语音”选项,默认为不播报语音。

	2. 收银台设置->基本设置:添加“用户视图按下Enter后”,弹出界面的反应,1:不弹出任何界面,2:弹出充值界面,3:弹出结账界面
	   收银台设置->基本设置:添加“用户视图双击鼠标后” ,弹出界面的反应,1:不弹出任何界面,2:弹出充值界面,3:弹出结账界面

2011-10-18
	1. 打印小票的字体改为 黑体，加粗,行间距增加4个单位

**********************************
*            8.2.0.6             *
**********************************

2011-10-11
	1. 收银员交款查询里的列表头的“交款人”改成“收银员”
	2. 上班时，修改本班备用金异常时的提示信息为：“备用金可能异常，请核查。”
	3. 点击增收宝时弹出的链接的linkPage=http://www.duduniu.cn/iba.jsp参数后面添加参数flag=duduniu, 
   	   (添加此参数兼容新旧中心, linkPage=http://www.duduniu.cn/iba.jsp不做删除兼容旧中心，添加flag兼容新中心)

**********************************
*            8.2.0.5             *
*                                *
* 直接从IBA8202过渡而来          *
**********************************

2011-9-28
	1. 删除交接班界面的“增收宝预存款余额”项。

2011-9-28
	1. 修改当网吧只有一个会员级别时，开户IBA会卡死的问题。
  	   同时修正点击“自动生成上网账号”时，IBA卡死的问题。

2011-9-25
	1. 点击重新计费后，用户视图用户激活时间改为当前，同时更新数据库.

2011-9-23
	1. 改变用户视图里的重新计费在右键菜单里的位置
	2. 添加重新计费的确认提示。

**********************************
*            8.2.0.2             *
*                                *        
* 需要以下动态库的支持：         *
*  DdnDataXU.dll     V1.0.0.1    *
*  DdnReport.dll     V1.0.0.1    *
*  DdnPcp.dll                    *
* 缺一不可，否则程序无法运行。   *
*                                *
**********************************

2011-9-22        
	1. 包时用户余额不足，查询中心返回不在线后，判断满足自动退款条件后就做自动退款处理。

2011-9-09
	1. 收银台打开之后的“帮助”菜单--“相关帮助文档”，请链接至http://news.duduniu.cn:8080/ido/temp/ddnwordhelp/Contents.htm
	2.“帮助”菜单--“关于”内，将"网吧增收宝"，修改为“网吧服务中心”，链接地址http://www.duduniu.cn

2011-9-08
	1. 增加IBA公告的显示功能。IBA每次启动都询问IServer是否有公告，如果有公告
  	   那么IBA就显示公告窗口。如果公告需要签收，公告窗口就会显示“签收”按钮，点击后
           IBA通知IServer签收已成功。(需要IServer3204以上版本)
	2. 打印设置里的临时用户开户默认打印。
	3. 增加Refund.txt临时用户退款打印模板， 
   	   增加RefundVIP.txt会员用户退款打印模板.
	4. 交接班里的增收宝消费= 原来的增收宝消费+点卡销售。

2011-9-07
	1. 收银台增加余额不足语音提示功能，并在客户端消息中增加“余额不足”的消息文字。
	   收银台设置->语音设置->增加“余额不足时，语音提醒”的复选框。
	   第一次播放提醒，收银台会写入语音文字到语音模板文件。
	  （需要UDO发送余额不足消息给收银台）
	2. 在收银台设置里添加新的设置页面“打印设置”，有关小票的打印设置。
	   用来设置开户，包时，充值，结账的打印功能是否默认开启。
	   改动：
		1) 把开户设置里的“开户默认打印小票”设置取消。
		2) 把基本设置里的“小票字体”的设置移动到“打印设置”
		3) 充值界面添加“打印小票”的复选框。
		4) 结账界面添加“打印小票”的复选框。
	3. 添加退款打印模板 Refund.txt
	4. 合并8135的点卡功能后，没有把收银员交款查询里的点卡销售相关信息合并进来。

2011-9-05
	1. 更新IBA8202，上一班预留金出异常情况的处理.判断配置文件和数据库中的上一班预留的金额是否一致,
   	   不一致就做提示。
	2. 过滤王刷卡后，如果没有发OnCloseUser消息，那么IBA在处理OnOpenUser消息时出现当前用户号对应的是前一个用户的信息。
	   解决方法：在OnOpenUser里判断当前刷卡用户的用户号是否和前一次查余额时的用户号一致，如果不一致，那么就再重新查一次余额。

2011-9-02
	1. 更新全场结账功能，解决关闭全场结账对话框时，IBA挂掉的问题。
	2. 保存在线销售，商品销售的最后的交易号和交易时间。
	3. 用户视图右键菜单添加“重新计费”的功能，支持多选。 添加快捷键C+R支持。

2011-8-31
	1. 修改刷卡后，充值或者结账对话框的焦点消失的问题。

2011-8-26
	1. 断网下，禁用点卡销售功能。
	2. 交接班的打印小票中添加点卡销售。需要更新ShiftCash.txt打印模板， 关键字[dianka]。

2011-8-25
	1. 合并8135的点卡功能到8201， 工具栏，菜单栏，上下班点卡销售显示。
           需要：DdnPcp.dll, DdnReport.dll(和8135一样，它需要注册)

2011-8-24
	1. 处理 修改备注时，备注对话框中没有显示修改前的备注的bug.
	2. 在快速通道栏的最右边添加 网络状态的显示（图片显示）. 正常模式-应急模式-恢复模式-尝试连接
	3. 工具栏最右边不再显示“应急模式”等字样，此处只做账号的显示。修改本地用户无法在右上角显示账号的bug。
	4. 鼠标移到网络状态图片上时呈手状，点击弹出悬浮提示。

**********************************
*             8.2.0.1            *
**********************************

2011-8-15
	1. 应急模式下，如果会员用户处于不在线状态，那么收银台判断它的最后一次的更新时间和当前时间的差是否大于60分钟，
   	   如果大于60分钟，那么就自动结账。写入checkoutinfo表，并且把登出时间改成最后一次的更新时间。
	2. 应急模式下，如果临时用户处于不在线状态并且账号还有钱，那么收银台会计算它的费用，如果它的余额为0，那么就自动退款。
   	   写入checkoutinfo，登出时间为当前时间。

2011-8-15
	1. 修改门店建设设置中的应急模式启动方式的控件文本。
	2. 在应急模式下，如果中心会员用户未上机，那么就自动结账。写入CheckOutInfo表。
	3. 修改网络连接失败后弹出是否进入应急模式的对话框。
	4. 修改如果收银员被中心强制下班后，数据补传连续失败导致收银员无法再次上班的bug。
	5. 取消“网络连接失败”的消息提示。取消“正在尝试网络连接...”的消息提示。
	6. 数据补传完毕，并且用户视图没有本地用户，点击交接班能及时的正常弹出交接班界面。

2011-8-11
	1. 在恢复模式下，交接班弹出恢复模式交接班界面（只做信息的显示）
	2. 本地用户使用，本地用户图标（绿色），用户视图颜色着色为绿色
	3. 结账界面，充值界面本地用户的图标显示。
	4. 门店建设设置里添加应急模式的启用方式配置: 禁用，手动(弹出进入应急模式确认对话框，如果确定进入，那么就弹出管理员密码验证)，
   	   自动。

2011-8-10
	1. 在应急模式下，自动对包时结束时余额为0的中心用户结账。写入CheckOutInfo表。
	2. 在应急模式下，自动对余额为0并且使用时间已到的中心用户结账。写入CheckOutInfo表。

2011-8-9
	1. 在正常模式下，上下班界面不显示“应急模式下一班转交金额”。
	2. 在应急模式下，开户界面做些调整， 开户对话框的窗口标题改为:“开本地用户 - (应急模式)”

2011-8-5
	1. 本地用户开户，密码采用DES加密,保存到ActiveMember的password字段。
	2. 修改中心用户在应急模式下不能换机得问题。
	3. 解决收银台重启或者刷新用户视图后，本地用户不能上机的问题。

2011-8-4
	1. 应急模式下，禁用收银台主菜单的某些菜单项。
	2. 应急模式下，禁用机器视图右键菜单的某些菜单项；本地用户充值可用，中心用户充值禁用。
	3. 支持本地用户换机。
	4. 开中心用户时，判断上网账号是否与本地用户的账号有重复，如果有重复，就不让开户。
	5. 添加本地用户自动退款功能。
	6. 应急模式下禁用账户直充功能， 恢复模式下不允许本地用户账户直充。

2011-8-1
	1. 在快速通道栏输入完整账号时，如果收银台为应急模式，那么弹出结账对话框。 
   	   如果为恢复模式，那么中心用户保持正常的流程，本地用户弹出结账对话框。
	2. 应急模式下，在快速通道输入终端号，能正常定位。
	3. 应急模式下，刷卡弹出结账对话框。

2011-7-29
	1. 在应急模式下，隐藏中心用户结账对话框的充值按钮,包时按钮。
   	   如果在点击结账按钮前网络是正常的，点击结账按钮时出现网络中断，那么允许进行断网结账。
	2. 在网络正常的情况下，针对中心用户, 充值时，如果点击充值出现网络连接失败，那么在此点击充值时提示“断网情况下，只允许本地用户充值”。
	3. 增加操作类型便于操作日志的显示
   	   1) 会员断网结账 : 中心会员用户结账。
   	   2) 断网退款 : 中心临时用户退款。
	4. 增加断网时的消息框提示， 工具栏右上角显示“应急模式(网络中断)”
	5. 应急模式下，禁用右键菜单的“消费记录”选项。
	6. 修改改本地用户充值后，修改密码的bug.
	7. 正常模式下，修改现金包时时，用户视图预付款和明细没有刷新的bug。

2011-7-28         
	1. 在断网情况下，在充值退款界面支持会员结账，临时用户退款，本地用户退款。(需要测试退款后，网络恢复正常是否能补传)
	2. 修改本地用户结账后，用户视图不刷新的问题。

2011-7-27
	1. 修改本地用户在用户视图右键点击上机，不能上机的bug。 (COleDateTime如果是0值，转换为字符串形式的时间出问题)
	2. 如果本地消费信息没有完全上传完毕（即LocalConsume表中还有数据），不允许下班。
	3. 交接班界面添加“应急模式下一班转交金额”显示, =在线用户表中的所有本地用户预付款之合。

2011-7-26
	1. 修改本地用户同一个账号可以多次开户的bug。
	2. 修改本地用户充值弹出充值对话框慢的bug。
	   修改断网情况下，弹出结账对话框慢的bug。
           原因：刷新机器视图时，调用中心的同步时间的接口等待时间很长导致的(GetTime接口)。
	3. 修改本地用户密码为空密码的用户能正常上机。(空密码不做MD5加密，出错前是因为对空密码补了8个0再加密导致无法上机)。

2011-7-25
	1. 在门店建设设置里，添加“允许在断网时自动启动应急模式”复选框的配置。
	2. 在断网的情况下，如果不允许自动启动应急模式，那么开本地用户需要输入管理员密码验证。

2011-7-20
	1. 支持断网状态或恢复状态下的全场结账。
   	  1) 会员用户直接结账,结账信息写入数据库CheckOutInfo表。
   	  2) 中心临时用户和本地用户显示在用户列表，需要收银员去点击退款按钮。
          3) 中心临时用户的退款信息写入数据库CheckOutInfo表。
          4) 本地用户的退款信息写入数据库LocalConsume表。
	2. 支持断网状态下，刷卡开户。
	3. 收银台登录时，如果最后一次关闭IBA的状态为断网状态，那么就进行本地登录。
   	   验证本地保存的收银员和密码。

2011-7-20
	1. 处理从断网到恢复过程中，IBA会挂掉的问题。原因：EnableNetwork被递归式的调用，进入死循环，最终导致IBA挂掉。
	2. 正常登陆后，保存实名类型，断网后重新登录能正常启用实名。

2011-7-19
	1. 触发网络状态为网络连接正常后，开启线程,每隔2分钟判断用户视图中是否有本地用户，如果有，那么
   	   就把网路状态设置为“正常状态”。每隔2分钟的同时向中心上传本地用户消费信息(把LocalConsume
   	   表中的数据上传), 收银员必须处于上班状态才能补传记录。
	2. 增加新的中心接口LocalConsume. 补传本地用户消费信息。
	3. 如果以中心在线的方式登入成功，那么在上班后执行 补传本地用户消费信息线程。
           逐条补传消费记录，收银台更新操作日志。

2011-7-18
	1. 允许本地用户结账，重新计算退款金额(预付款-每小时的扣率*相应时间段的时间长度)
   	   如果用户处于上机状态，那么就通知客户端锁屏、清除lastuser表中的对应终端的记录、
   	   写消费信息到LocalConsume表。

        2. 生成操作日志记录, 增加操作类型100(本地用户退款).

2011-7-15
	1. 不允许中心用户在断网状态下上机，用户视图右键菜单的上机按钮变灰。
	2. 不允许中心用户在断网状态下充值，用户视图右键菜单的充值按钮变灰。

2011-7-14
	1. 测试，调数据库。
	2. 允许断后后可以登录。
	3. 网络恢复后，自动调用上下班接口，进入正常的上班状态，可交接班。

2011-7-13
	1. 断网后，收银台可以重新登录. 只保存了账号密码班次ID
	2. 断网后，禁用充值修正功能。
	3. 删除所有原始的断网模式。

2011-7-12 　　　　
	1. 在CServletMethod::OnEnd中添加是否真实断网的判断,如果断网就调用CBrokenNetwork::DisableNetwork方法。
          1) 添加 CBrokenNetwork类， 断网下的控制类
          2) 添加 CBrokenNetwork::DisableNetwork  (断网处理)
             CBrokenNetwork::EnableNetwork   (网络恢复处理)
	2. 在断网的情况下，让中心用户能正常结账。网络恢复后能正常补传
	3. ActiveMember表增加字段netIdAlias,上网账号别名(客户端要用到；在开户时，取上网账号的后8位，并且去掉左边的0.

2011-7-11
	1. 充值界面的本地用户信息的显示。
   	  1) 添加CNDDialog::DoLocalModeQuery   本地查询方法, CNDCreditDlg重载此方法
    	  2) 添加CNDDialog::DoLocalModeOperate 本地操作方法. 充值对话框，结账对话框都重载此方法。                 
	2. 不允许本地用户跨区域换机， 在CNDCheckInDlg(上机对话框)的终端列表中只列举同区域的机器。

2011-7-8
	1. ActiveMember表增加 
		dynamicMaxAmount(累计封顶额)、
		isLocal(是否本地用户)、
		password(上机密码, MD5值)字段。

	2. CActiveMember 类添加属性：
		DynamicMaxAmount
		IsLocalUser
		Password
   		属性的默认初始化。
	3. CActiveMemberList::LoadFromDB增加对以上3属性的读取.
	4. 在CActiveMemberGrid中添加行时，给本地用户着色。
	5. 保存第2点中的3个属性到数据库。
	6. 如果用户为本地用户，禁用右键菜单包时包时选项。
	7. 在包时对话框中添加本地用户不允许包时.
		1) 在OnInitDialog中，如果为自动查询，那么就判断要查询的账号是否为本地用户，如果是就做提示，并且关闭对话框.
		2) 在OnBnClickedButtonQuery中添加账号是否为本地用户的判断，如果是，不做任何动作。
	8. 在结账对话框的 OnInitDialog中， 判断是否为本地用户，如果是就隐藏包时按钮,或者网络状态为断开也隐藏包时按钮。
	9. 在充值对话框的 OnInitDialog中， 判断是否为本地用户，如果是就隐藏包时按钮,或者网络状态为断开也隐藏包时按钮。

**************************
*        V8.1.3.5       *
**************************
2011-8-4 
   1. 收银员交款查询中添加“点卡销售”列， shiftList中心请求接口的返回报文添加thirdPartCash字段。

   2. 更新交接班报表功能。报表中添加点卡销售，增收宝销售。（增加DdnReport.dll）

2011-7-27
   1. 工具栏添加“点卡销售”按钮，未上班状态按钮为灰色不可用。点击按钮弹出“嘟嘟牛点卡销售平台”窗口。

   2. 交接班界面添加“点卡销售”项， 修改班次收入,累加点卡销售额。

   3. 收银台增加“DdnPcp.dll”实现点卡销售平台的显示。

2011-7-26
   1. ConsumeList接口的申请报文增加字段maxConsumeType(最大消费类型), IBA自动填充此字段为99.

   2. 用户消费记录查询视图的消费类型增加“附加费”,它的类型值=9。

   3. 在交接班界面添加“点卡销售”的显示。ShiftTotal接口增加thirdPartCash字段(返回点卡销售额)

**************************
*        V8.1.3.2       *
**************************
2011-7-29
   1. 修改：现金包时时，普通包时和自定义包时没有刷新用户视图预付款和明细的bug。

2011-7-28
   1. 修改：充值修正，修改金额后，收银台通知客户端的信息。 “充值金额xx,修改后的金额为：XX”
   
   2. 把主菜单的“充值冲正”改为“充值修正”

2011-7-22
   1. 修改GDI资源泄漏的BUG。

**************************
*        V8.1.3.1       *
**************************
2011-7-19
   1. 结账界面：如果是会员用户，就把结账按钮的名称改为“会员结账”，窗口的标题也改为“会员结账”，
                   余额的颜色改为蓝色。

**************************
*        V8.1.3.0       *
**************************
2011-7-8
   1. 取消在本地模式下，点击交接班时，要求输入权限密码后才弹出交接班对话框的限制。
         原因是没有IBAP_ONOFFDUTY权限，断网模式下取消IBAP_ONOFFDUTY权限的判断。

2011-7-6
   1. 版本8120直接转为8130。

**************************
*        V8.1.2.0       *
**************************
2011-7-5
   1. 在语音模板里添加“BundlePatch=转包时成功，补扣金额%.2f元。”, 并且在转包时成功后，进行语音播报。

   2. 修改快速通道终端查找时， 用户视图定位准确，但机器视图定位有问题的bug。

   3. 自动填写IBATTS.ini文件的参数 “BundlePatch=转包时成功，补扣金额%.2f元。”

2011-7-4
   1. 修改开户上机的用户（实际未去上机），机器视图的用时显示为一个很大的整数。
        (原因：当前时间-0 = 很大的整数, 因为未上机，所以上机时间为0，导致此问题发生)

   2. 快速通道查找终端，如果有用户视图中这个终端对应的用户有多个，那么就选择那个最后一次更新时间最接近当前时间的用户。
        (注：可能影响到快速通道中的其他查找方式，需要再次测试)

2011-7-1
   1. 修改开户包时（累计封顶的包时）成功后，用户视图预付款和费用显示有误的问题。

2011-6-30
   1. 添加参数gintForbidModifyPwd控制是否禁用修改密码的功能, 0：表示启用，1：禁用。

   2. 修改当点击结账界面的“退包时后余额”按钮成功后， 用户视图的预付款刷新问题。

   3. 修改鼠标连续快速点击结账对话框的“结账”按钮时可能出现连续响应多次“结账”的问题，导致中心处理多次结账。

2011-6-29
   1. 修改打开增收宝视图后，再关闭IBA出现IBA挂掉的问题。

   2. 未上班状态，禁止用户视图每隔30秒刷新一次。

   3. 修改在挂机状态下，不允许充值。不允许充值的时候弹出消息框提示。

   4. 自动对款的时候，刷新机器视图。

   5. 修改打开增收宝后，在页面中输入账号全部输入到快速通道的bug。

2011-6-28
   1. 去掉门店建设设置对话框里的 负责人和电话。

2011-6-27
   1. 操作记录查询的操作类型中的充值冲正改成撤销充值。

   2. 更新充值、包时、充值冲正等对话框中的上网账号记忆功能。
         1) 用户视图，鼠标单击某个用户， 记忆的账号为点击的这个用户。右上角账号无变化
         2) 用户视图，双击某个用户，记忆的账号为点击的这个用户。 右上角显示对应的账号
         3) 刷卡， 记忆的账号为卡的账号。

2011-6-24
   1. 修改充值修正后，操作日志显示有问题的bug。

   2. 如果参数gintNoModifyMember设置为1 的话，禁止收银台修改用户密码。

2011-6-23
   1. 交接班中的班次收入累加工本费。

   2. 修改断网后，连续结账会卡几秒的问题。 (由于结账后查询消费记录导致的)

   3. 修改退货后，用户视图余额没有刷新的问题。

   4. 在收银台设置添加“在登录界面显示启用断网模式按钮”. 登录界面添加新按钮。
        1) 如果登录界面按钮显示为“启用断网模式”,重启收银台后就可以用断网模式去登录
        2) 如果登录界面按钮显示为“关闭断网模式”，重启收银台后就可以用正常模式去登录

2011-6-22
   1. 充值修正功能中的修改界面的文本提示改为：“说明：\n   1、收银员多充钱给用户时，使用本功能。\n\n   2、系统不允许输入负数（例如-1），如果用户已将充错的钱用完，		修改会提示余额不足。”

   2. 调整交接班界面的押金控件。公式的文字修改。

   3. 修改充值修正功能中的“修改充值金额”和“撤销充值”弹出一样的确认框的问题。

2011-6-21
   1. 版本号从8113改为8120。
   
   2. 充值冲正界面文字的更改，修正改为：“修改充值金额”,冲正(修改) 改为：“撤销充值(冲正)”

   3. 收银台开户设置，只有密码类型为“固定密码”时，密码编辑框为可编辑。其他的密码类型密码编辑框
      为不可用并且显示内容为空。

   4. 断网后，用户视图结账时，添加操作日志的显示，操作日志的备注项里添加“网络断开连接后的结账”文字。
      断网恢复时，操作日志的备注项里添加“断网续传”文字。


**************************
*        V8.1.1.3        *
**************************
2011-6-20
   1. 修改优化刷卡流程后，导致充值后的用户视图的用户余额没有刷新的问题。

   2. 包时时间限制的配置的保存改成保存到数据库。

2011-6-17
   1. 去掉以文件的方式播放生日快乐， 语言模板文件IBATTS.ini添加参数“Activation2=祝您生日快乐,激活成功,余额%.2f元”。
          Activation2默认为“祝您生日快乐,激活成功,余额%.2f元”。

   2. 用户消费记录视图的结束时间起始默认时间改为“当天时间的后一天的00:00”, 例如:
         “2011-06-17 17:28” 改为 “2011-06-18 00:00”。

2011-6-15
   1. 保存当前班次的所有操作日志, 操作日志、刷卡记录、客户端消息

   2. 更新2011-6-14的第1点无效的问题.

   3. 修改客户端换机后，机器视图有账号重复的问题。

   4. 支持卡作废后可退款。

2011-6-15
   1. 优化刷卡流程，减少和中心的查询次数。

   2. 修改增收宝广播，播报信息时IBA可能挂掉的bug。需要重新测试广播功能。
   
   3. 1) 刷卡激活时，判断是否当天是否为生日，并播放“祝您生日快乐”的祝福语。需要文件“Shengri.wav”声音文件。
         需要把声音文件放在“IBAConfig”目录下。
      2) 并且在充值界面显示“今天是他生日”的红色字样。

   4. 保存当前班次的所有操作日志。

2011-6-14
   1. 修正断网下，IBA登录收银台用户自动查询余额传给中心为在线状态，导致多扣会员用户金额问题。如果上一次的
         的更新时间和当前的时间差>10分钟，那么传给中心不在线状态.

   2. 修改登录界面的全场结账功能无效的bug，(从数据库ActiveMember表中读取数据)。

2011-6-13
   1. 增加对过滤王新接口的支持。（不支持模拟刷卡，需要到过滤王公司测试）

   2. 增加DdnDataXU.dll。

2011-6-10
   1. 添加：网吧配置参数“gstrKillCaptions”, 配置了此参数就表示要强制关闭所有窗口标题为gstrKillCaptions值
            的子串的窗口。例如：gstrKillCaptions=网吧开户辅助|ABC;  强制关闭窗口标题为“网吧开户辅助”和
            “ABC”的程序。 缺省为空，不关闭任何程序。
         取消“gintkillregisterhelper”的参数配置。

   2. 修改：开户时，勾选“自动上网账号”,账号格式= 0 +“4位的网吧ID”+“5位数字”。

2011-6-9
   1. 修改：“上下班”中“商品采购支出”用负数形式显示。

   2. 修改：解决当“客户端”关机未结账时，机器视图刷新用户信息消失的问题。

   3. 添加：在“收银台基本设置”里，添加“离包时结束XXX分钟之内不允许包时”的配置。如果输入为0，
            默认50分钟。

2011-6-8
   1. 修改：用户视图的排序
            1)新增用户显示在用户视图的第一行。

	    2)所有的“未上机”用户位于“已上机”用户的前面。

            3)增加“未上机”用户的激活时间排序功能。未上机的用户始终按照时间来排序,不受表头的排序列的影响。
            
            4)表头的排序列只影响“已上机”用户。

   2. 修改：对于不是同一天激活的用户，“未上机”用户的排序可能出问题的bug.
            
2011-6-7
   1. 修改：1)交接班界面相关参数的计算方法
               班次收入 = 充值 - 退款 + 押金 + 购物 - 采购支出 - 其他支出
               现金总额 = 班次收入 + 上一班预留   
               上缴金额 = 现金总额 - 留给下一班

            2)“本班现金收入”名称改为“班次收入”。
            3) 调整界面。

   2. 修改：快速通道输入终端号(<=3位),输入账号(4、5位)

2011-6-3
   1. 修改：快速通道的输入控制修改, 可输入用户号或者终端号， 禁止视图间的自动切换。

   2. 修改：只允许在上班和处于上班状态的时候，执行断网恢复补传。

   3. 修改：当设置开户会员密码为空密码时，会员密码被初始化为123的bug。
   
   4. 修改：进销存->退货的允许当前班次的前24小时退货。

2011-6-2
   1. 修改：在和中心断网的情况下，如果数据库连接有问题，那么就禁止断网结账(在结账时提示数据库连接失败的消息框)

   2. 修改：在工具栏添加“网络连接中断”的提示后，由于程序错误，导致自动对款功能失效， 修正此问题。


2011-6-1
   1. 修改：用户视图的列表的某列被选为排序参照列时，关闭收银台没有记忆它的bug；默认每次都是
         按照时间来排序。

   2. 添加：客户端钱用完之后，自动锁屏，收银台消息记录中显示“没钱了，锁屏”。

   3. 添加：当中心断网的情况下，在工具栏最右边显示“网络连接中断”, 如果在收银台设置里，设置了不显示，
         此处仍然显示“网络连接中断”。用红色显示

   4. 修改：当收银台开户时设置“用户输入密码”时， 弹出密码输入框，按“ESC”后，密码输入框关闭，
         如果没有输入密码，也能开户是个bug。

2011-5-31
   1. 修改：在中心断网的情况下，添加用户视图连续结账的功能. 断网时能显示账户余额，用户姓名等。

2011-5-30
   1. 修改：2011-5-26的第6点修改没有成功的问题， 即修改时，先充值成功在冲正失败后，充值记录多了一条充值信息。
         如果冲正失败，就需要删除当前的这一条充值成功的信息。

   2. 修改：在“充值修正”对话框中点击“修改”后，会出现两次询问“是否确定充值冲正”的消息框,改为只提醒一次。

   3. 修改：“充值修正”的修改功能，不能修改为有小数的金额，例如：
          “5.50”会显示充值为“5.00”,改正此问题。

2011-5-27
   1. 在用户视图双击已销户的用户，做提示，并且立即刷新用户视图。

   2. 添加：“收银台设置”->“进销存”->添加是否“现金支付”的复选框， 
        入库接口增加“现金支付/非现金支付”字段。

2011-5-26
   1. 修改：“充值修正”的“修改”功能弹出的对话框关闭时仍然进行修正的bug。

   2. 添加： IBA右上角账号点击功能，点击后选择用户视图对应的用户。
      如果账号处于上机状态，机器视图也对应选择机器。
   
   3. 设置IBA右上角账号，设置状态默认为选择。

   4. 添加：“收银台设置”->“开户设置”->“临时用户密码”类型添加“空密码”的设置。
          如果选择空密码，开户后，账号的密码为空。密码对应的加密串改为16个空格。

   5. 修改：在快速通道栏，按“ESC”键，快速通道栏消失的问题

   6. 修改：当点击“充值修正”的功能“修改”时，如果先充值成功后再冲正失败， 充值记录多了一条，并没有
         修正。 修改后，如果冲正失败，就刚刚充值的这一条冲正（自动删除）
   
2011-5-25
   1. “充值修正”页面进行了调整，进行如下调整：
      1) 只保留了“用户姓名”、“证件号码”、“账户合计”基本信息的显示。
      2) 充值历史列表的列改为“充值时间-充值金额-赠送金额-修改按钮-删除按钮”。
      3) 点击“修改”按钮，弹出对话框要求输入新的充值金额(先充值，再冲正)。
      4) 点击“删除”按钮，直接选中行的充值记录进行冲正。

2011-5-24
   1. 修改：在快速通道输入终端号后回车，如果当前视图为用户视图，那么收银台自动切换到机器视图。
      修改：在快速通道支持模糊的用户账号查找, 如果有多个账号，那么收银台就弹出账号选择对话框。
   
   2. 修改：在工具栏“充值退款”、“充值修正”、修改密码”、“包时”和菜单命令“账户直充”弹出对应的
            对话框， 有用户账号的记忆功能，并且自动查询这个账号对应的相关信息。
   
   3. 修改：将“充值冲正”改为“充值修正”。
      添加：在“用户视图”右键菜单添加“充值修正”功能。        

**************************
*        V8.1.1.2        *
**************************
2011-5-23
   1. 修改：修改第三方消费接口的操作员参数的类型,原“数字”改为“字符串”类型。
      (增收宝广播滚动文字用到这个接口)

2011-5-20
   1. 修改：离包时结束时间，在50分钟以内，允许自定义续包时。

   2. 修改：当点击“包时”成功后，立刻禁用“包时”按钮, 包时失败,“包时”按钮仍然可用。

2011-5-19
   1. 添加：在“收银台设置”->“上下班”->添加“允许编辑留给下一班金额”的复选框. 

   2. 修改：开包时用户，用户视图中费用=包时费用, 预付款=余额+费用, 如果开户包时后处于未上机状态，
         那么用户视图“备注”列显示“包时未上机”. 如果处于上机状态话，备注不显示“包时未上机”。

   3. 实现第2点的修改，在数据库中ActiveMember表中添加字段"registerBT"是否开户包时, 1表开户包时，0表示正常开户
   
2011-5-18
   1. 修改：快速通道的下拉列表选择某项后，再回车，弹出“卡号不存在”的消息框.  

2011-5-17
   1. 修改：充值冲正后，“用户视图->预付款”也做相应的变化。

   2. 修改：后台设置“允许账户直充”后，IBA的菜单里没有“账户直充”的菜单项。

2011-5-16
   1. 在“用户视图”中把“备注”改为明细,并在用户列表添加“备注”列。

   2. 在“用户视图”右键菜单添加修改“备注”的功能(弹出修改备注对话框),  保存到数据库。

   3. 调整“上下班”对话框的控件的位置, 
      修改“上下班”对话框的“上缴金额”的字体大小和颜色(红色)。
      修改“上下班”对话框的“上缴金额”标题的字体大小+加粗。
      调整“充值”对话框和“结账”对话框的“查询消费记录”控件的位置。

   4. 修改：收银台增加参数 gIntMustAutoReturn ，这个版本增加。
        为 1 时，强制自动退款时间为0， 收银台设置的自动退款时间无效。
        为 其他值 时，使用收银台设置的时间。

   5. 修改：当用户账号后几位为字母时，假设用户视图里有用户“0010abcdef”,在快速通道里输入"cdef"再“回车”,
        没有弹出对应用户的“充值”或者“结账”对话框。在原来版本的情况下，在快速通道里输入字母，表示查询终端。
        现在改为：如果在输入字母的情况下，那么先在用户视图里查找(找到就做相应处理)，如果没有找到，
        就在机器视图里查找终端。

   6. 修改：数据库中保存了级别ID和级别名称的对应关系.在数据库中的这个关系如果没有和
	中心同步的话，可能存在以下问题: 客户端上报给IServer的classID，IServer
	如果在数据库中找不到这个classID的对应的级别名称，那么IServer就会把这个
	classID当成 级别名称传给IBA, 这个时候“用户视图”里的“用户级别”就显示
        为一个数字.  

   7. 修改“增收宝广播”的喇叭的持续时间为1分钟。

   8. 修改：刷卡后，点击工具栏中的“充值退款”、“包时”等对话框的上网账号没有刷新.

2011-5-13
   1. 修改“开户”对话框的“进行无送充值”的说明文字为“这些钱可以到增收宝消费”

   2. 修改：进销存中，当本地数据库中的库存数量为负数时，界面显示很大的改成负数的形式的显示.

   3. 收银台增加参数 gIntMustAutoReturn ，这个版本增加。
        为 1 时，强制自动退款时间为0， 收银台设置的自动退款时间无效。
        为 0 时，使用收银台设置的时间。
   
   4. 修改“充值”对话框的“详情”链接地址为:“http://www.duduniu.cn/index.jsp”
      修改点击工具栏“增收宝”按钮，弹出的增收宝视图的链接地址为:“http://www.duduniu.cn/iba.jsp”

   5. 任子行实名登记程序rzxsurename.exe经常会因刷身份证会卡死，经常需要结束进程或重启动电脑才可以正常，
     按照任子行的要求我们收银台登录的时候必须加载任子行登记程序关闭的时候必须也关闭任子行的程序，
     我们目前是通过实名接口程序来加载RZX。 退出时关闭掉 任子行的进程“rzxsurename.exe”.



2011-5-9
   1. 双击用户视图，如果用户已经被注销，则从用户视图删除。

   2. 在快速通道输入框的右边添加增收宝广播, 广播的内容每隔10分钟从中心更新一次,
        每次打开IBA时广播内容也会更新一次.更新的同时，小喇叭会在白和黄之间切换(持续3分钟).
      广播的内容每隔5秒钟轮换(向上滚动切换).

   3. 在工具栏最右边添加“增收宝”按钮,点击后在“机器视图/用户视图”的生成“增收宝”视图,
      视图中显示增收宝首页.

   4. 在上下班模块增加 增收宝栏目(包含增收宝消费、预存款余额)

   5. 在IBA下中，消费信息列表中的 “嘟嘟牛消费”改为“增收宝消费”,
                                    “嘟嘟牛充值”改为“增收宝充值”

   6. 在“充值”中添加“查询增收宝消费记录”链接按钮,当点击“充值”界面中的“查询消费记录” 
      or “查询增收宝消费记录”时，激活消费信息列表，并用红色框框闪烁一次，以示提醒.
      把进行“进行无送充值”的说明改为“这些钱可以到增收宝消费”,并添加“详情>>”链接，点击后
         弹出增收宝相关详情网络页面.

   7. 在“结账”中添加“查询增收宝消费记录”链接按钮,当点击“结账”界面中的“查询消费记录” 
      or “查询增收宝消费记录”时，激活消费信息列表，并用红色框框闪烁一次，以示提醒.

**************************
*        V8.1.1.0        *
**************************
2011-5-4
   1.结账界面增加包时链接。

   2.当用户为待退款状态时，自动退款时不在判断条件。

2011-5-3
   1. 修改：收银台设置->基本设置->"显示客户端消息在屏幕左下方"配置没有保存的问题

2011-4-28
   1. 修改：在开户包时,如果后台没有给当前收银员指定“自定义包时”权限时,那么在点开 包时下拉列表选择“无的下面的一项”，
         程序会弹出自定义包时的对话框. 修改权限的判断.

2011-4-27
   1. 修改：进销存模块里面的，选择商品时，出现商品库存数量是很大数据的问题,其原因本地库存的库存数量为0时，
         还进行购物，导致本地库存中的库存数量减为负数. 因此再次查看时出现数据很大的问题。

   2. 修改当开户未消费界面中的列表没有数据时，双击弹出对话框的bug。
         改成双击时并且选择了某一项时，弹出对话框。

   3. 将收银台设置->开户设置->"开户立即扣费" 选项删除。

   4. 将收银台设置->充值退款设置->"临时用户钱用完多少分钟后自动对款"的最大输入数字位数改为6位。

   5. 将客户端设置->基本设置->"当余额不足使用多少分钟时开始提醒用户"的最大输入数字位数改为6位。

2011-4-26
   1. 修改：禁止测边栏、信息栏可浮动

   2. 如果客户端超过6分钟没有上报数据给ISERVER，查询余额时则认为终端不在线。

   3. 将第2条改成：如果客户端本地在线时，查询余额时时则认为终端在线，否则终端不在线

2011-4-25
   1. 修改：修改账号后，用户视图中对应账号的新账号没有更新的bug

   2. 修改：客户端设置-->“下机锁屏时间”改成“锁屏时间”

   3. 修改：合并账户成功后，从用户视图里删除被合并的账户

   4. 修改：开户包时后，用户视图里对应用户的预留金额=账户余额(之前用可退余额计算)

   5. 修改：当前版本和8.1.0.6旧版本测边栏显示的兼容问题

2011-4-22
   1. 修改：开户选择一个现有的包时，然后再自定义包时、如果自定义包时金额小于之前所选包时的话， 
      就会提示这个开户金额不足

   2. 时长目前最多累计到24小时,修改为总时长(不限时)

   3. 删除收银台设置--充值设置--包时前是否判断充值金额

   4. 去掉充值退款界面中的选择包时功能，然后由于某些原因又把选择包时功能添加上去

2011-4-21
   1. 修改语音播报中不能播放负数有误的BUG

2011-4-20
   1. 在用户视图右键菜单添加发送消息功能，支持多选

   2. 修改客户端基本设置的下机锁屏时间输入框最多允许输入6个数字

2011-4-19
   1. 开户包时后,预付款显示有问题;修改用户视图中预付款的显示

   2. 添加每次登陆时判断IBA是否有更新

2011-4-18
   1. 开户界面中，添加自定义包时功能

   2. 开户自定义包时，累计押金等金额

2011-4-15
   1.开户包时直接使用新的开户包时功能，不再使用以前先开户后包时的方法。

   2.调整的包时界面，客户端设置界面的部分文字，删除收银台设置开户设置里面的开后后立即扣费的选项。

   3.中心收银台控制参数增加gintScanEnabled，为1时，且选择了扫描仪，则扫描菜单可用。

2011-4-13
   1.包时界面的控制调整

     当用户包时且离结束时间超过50分钟，不可续包时即此时包时按钮不可用。

     当用户包时且离结束时间超过50分钟，如果选择的包时开始时间、结束时间和当前包时一致，价格大于等于当前包时价格，则可以进行转包时。显示的应收现金或者应扣账户为包时的差价。

   2.收银台设置增加消息相关设置。


2011-4-12
   1.临时用户退款，收银台通知客户下机，等待0.5S后结账退款。

   2.修改现金包时取消后的提示。

2011-4-11
   1.修改自定义商品编码不能退货的问题。

2011-4-7
   1.修改关于模块，代理信息模块，帮助菜单等。

   2.包时失败且中心返回需要登录的，包时按钮等待3秒后才能再次点击。

2011-4-6
   1.包时模块增加充值链接，仅在允许账户包时的情况下显示。

     从包时模块进入的充值界面结账和包时链接不可用。

   2.不显示上下班界面的“批量结账”按钮。

2011-4-2
   1.把包时的报文pcClass改成1个字节

   2.修改自定义包时，客户端自动重新登录

   3.增加账户直充模块。（需要中心设置才可见）


2011-3-30
   1.修改包时模块，使用中心新的包时接口，需要测试各种包时情况。
   
   包时成功后，根据中心返回是否需要通知客户端重新登录来通知客户端重新登录。

   每隔10秒钟通知一次，直到成功为止，但最多不超过1分钟，超过一分钟后提示收银员且不再通知客户端重新登录。


   2.动态备用金：临时用户开户时，会把收银台ID保存在ActiveMember表，为了统计备用金。

   这样就可以根据不同的收银台ID来统计动态备用金，如果没有存收银台ID的临时用户则认为其收银台ID为1（也就是主收银台，要求主收银台ID为1）。

   （需详细测试）

   3.调整用户视图内存结构的大小，提高工作效率。

   4.IBA启动时会清除ActiveMember中activationTime为空的记录。（以前版本遗留下来的数据）

     更新ActiveMember中status为0（待上机状态）且activationTime大于24小时的用户status为3(待退款状态)。为了解决以前版本因为自动累计封顶包时遗留的数据。
   
     修改定时往中心查询的算法：如果临时用户不在线且包时，则更新status为2，下次查询时间为包时结束时间。

   5.修改机器视图用户视图不能按金额排序的BUG.

   6.调整收银台消息接收对话框，增加图标，支持复制操作。

   7.进销存查询模块：从数据库加载收银员名称到收银员组合框。

   8.客户端会员结帐时，收银台会自动在客户端消息增加一条会员结帐记录。

   9.当收银台登录，根据中心返回是否需要同步进行自动同步。

2011-3-28
   1.充值模块，当进行无送充值时，提示收银员。

   2.会员结账和临时用户退款统一到一个界面。

   3.当用户在用户视图里面时，刷卡(包括回车、双击、便捷通道)均弹出结账界面，即临时用户、会员用户统一。

2011-3-24
   1.开户设置增加默认用户级别设置。

   2.如果用户的名字超过10个字符则自动截取前10个字符。

   3.启动时清除用户视图中没有激活时间的记录。

   4.修改刷卡强制置前的问题。（现在只针对RZX强制置前）

   5.客户端设置增加“允许重启自动登录”的设置，需ISERVER3.1.1.5的支持。

2011-03-22
   1.修改：收银台设置->充值退款->使得临时用户用完多少分钟的编辑框可编辑（修改外面临时用户用完多少分钟的编辑框不可以编辑的BUG.）
   
   2.添加：中心查询余额接口增加用户实际在线的参数，收银台查询余额时根据客户端是否在线来传此参数给中心。

2011-03-17
   1.添加： 包时，结帐对话框中账户合计可以点击，显示详细资金信息气泡

2011=03-16
   1.修改：上下班对话框中，按回车并且同时鼠标点击下班按钮时，弹出两个是否下班的消息框的bug

2011-03-15
   1.修改：当商品入库的单位倍数为0时，IBA挂掉的bug。

2011-03-14
   1.修改：当取消激活时，如果临时用户为漫游的，那么就从当前用户表中删除用户

2011-3-9
   1.增加保存操作日志的功能。

   2.收银员登录后，显示他最近的50条操作日志。

2011-3-8
   1.去除用户视图和机器视图中的Grid的空白列的宽度，隐藏单击行时的三角符号.

2011-3-7
   1.在快速通道中输入上网账号按回车后或者刷卡，在用户视图选择对应的用户行。

2011-3-4
   1.在工具栏添加当前操作的用户的上网账号.（收银台基本设置里面可配置是否显示）

**************************
*        V8.1.0.6        *
**************************

2011-3-15
  1.修正一个可能进销存入库时可能崩溃的BUG。（commodity表unitMultiple为0会崩溃，即中心商品定价的单位换算关系为0）

  2.过滤王实名下，如果启用强制扫描，则会对刷卡的信息进行验证，防止某些破解软件。

  3.增加冲正操作日志，冲正模块和包时模块（包时失败自动冲正）。

  4.转包时不做金额判断。

  5.修正退款的用户不能查询消费记录BUG。

**************************
*        V8.1.0.5        *
**************************
强制要求使用ISERVER 3.1.1.4，否则程序无法启动!

2011-2-24
  1.增加在屏幕右上方显示最后操作的上网账号的窗口（在字按下鼠标可以移动），需要在收银台设置启用。

2011-2-23
  1.包时界面增加“无送充值”选项，限制最大充值金额1万。

  2.修改收银员交款查询显示顺序错误的BUG。

2011-2-21
  1.修改收银员交款查询的界面。“上一班预留”改为“留给下一班”，修正退款金额错误的BUG。

2011-2-18
  1.网盾实名下，IBA关闭为强制退出。


2011-2-15
  1.为了减少访问IBA定时访问中心的次数，对定时访问往中心查询余额的算法做了修改。

	a.刚开户未上机的不定时查余额。(有个问题，开了包时卡的用户，过了时间没上机的不会自动退款)
	
	b.正常上机，客户端能连接上ISERVER的不查。
	
	c.用户上机了，客户端连不上ISERVER的或者客户端关机定时往中心查一下余额。（定时是指每次查询之后中心会告诉IBA下次查询的时间）
	
	d.用户不在线，且没钱了不查，直到自动退款的时间到了才往中心查一次，满足自动退款条件则自动退款。

  2.修改IBA充值退款设置，删除启动自动退款的设置项。

**************************
*        V8.1.0.4        *
**************************
强制要求使用ISERVER 3.1.1.3，否则程序无法启动!

2011-1-27
  1.结账界面增加退包时后余额的功能。（临时用户，包时，且有余额才显示）

  2.进销存入库时使用商品条码改为使用商品编码，因为自定义条码入库后在中心查不到。

2011-1-26
  1.便捷通道输入后4位，只能查询到2011.1.1之后在收银台查过余额的用户。

2011-1-24
  1.修改了挂机功能。

  2.如果没有开启自动退款功能，则IBA不定时往中心查询。

  3.修正了交班总金额为负数时，其他支出输入无效的BUG。

2011-1-21
  1.支持主、备、异地三服务器异常自动轮流切换。

  2.点视图右键结账菜单结账会员时，如果会员包时未结束会有相应的提示。

2011-1-20
  1.支持开户上机（上机就是开始计费），如果上机成功，则会在用户视图显示相应的机器和计费信息。

同时用户到指定的机器开机也会自动登录。

  2.增加自动实现对充值卡充值功能。

  a、收银台自动查找对应金额的充值卡，自动进行充值，中心定义按固定前缀编码（定义CZK开头的）定义充值卡商品，收银台利用积分兑换完成此功能。

  b、程序做到兑换充值卡后自动查找IBAConfig目录，找到cards.txt文件，自动完成充值操作（成功失败都会提示）。

2011-1-19
  1.修改了自定义包时，增加包时结束时间。

  2.修改了可能导致显示金额很大的问题。

  3.气泡提示：如果中心操作失败则用红色的背景。（可能会有个别的没有改到）

  4.收银台登出成功后运行实名代理程序（启用了实名且要求代理程序放在IBABin里面），并每10秒检查一下。

2011-1-18
  1.修改收银员操作查询，全部改为从中心查询。

（中心限制每次最多查询100条，如果多于100，要使用上下页功能。中心限制最多查询15天的数据。）

  2.调整了部分菜单的名称和位置。

2011-1-14

  1.调用用户视图的列顺序并改变部分列的名称。机器视图改变了部分列的名称。

  2.用户视图增加预付款和备注。

预付款为激活时的余额（或者开户金额）加以后每次充值的钱。

备注为充值过程(冲正)或购物过程。比如用户余额为10.10，充值50送5，账户购物2元，显示为10.10+50送5-2。

  3.用户视图右键菜单增加上机功能，需要最新编译的ISERVER3103和UDO9034支持。

  4.机器视图右键远程操作菜单增加解屏功能。

  5.修改实名设置的相关显示，根据后台的设置显示相应的实名配置名称。

  6.全场结账增加打印功能。

  7.收银台附加设置增加 gintInputActivation，如果设置为1，在便捷通道输入大于等于6位而且是有效用户的上网账号，等同于直接刷卡。

  8.修复开户界面没有设置临时用户导致出错的BUG。

  9.上下班模块增加权限控制。

  10.交款查询改成中心查询，为0的数据显示为空。

2011-1-11
  1.调整机器视图的字段顺序，删除电脑名称、用户号字段，"终端号"文字改成"电脑名称"。
  
  用户视图、机器视图：删除性别字段，性别显示在姓名后面，格式： XXXX(男)

2011-1-10
	1.支持续包时。
	
	a、用户不在线，收银台点包时，提示‘是否续包时’，点是，程序自动取消当前包时，再对当前包时进行包时。
	b、用户在线，收银台点续包时，（实现方法和在线包时一致），提示包时成功或者失败。（需要UDO9.0.2.7以上版本支持）
	
	2.支持包时前先充值，包时界面增加金额输入框。修改充值界面的包时链接，直接链接包时收银台包时界面。
	
	3.开户界面和充值退款界面的选择包时支持按用户级别自动过滤。
	
	4.机器视图和用户视图增加右键在线购物菜单。
	选择后直接弹出商品销售模块，显示在在线购物项，终端号自动传到输入框并查询信息，焦点停留在商品编码输入框中。
	
	5.收银员操作查询增加用户级别查询条件。
	
	6.机器视图右键菜单“仅刷新此终端”，可疑电脑发送ARP不成功恢复成离线状态，离线状态发送ARP成功变成可疑电脑。
	
	如果用户在线，则会请求客户端查一下余额并上报给ISERVER。
	
	7.在开户或者退款时，member表的available字段记录用户当前状态0：正常；2：退款。
	
	此功能是为了在快捷通道模糊查找时过滤一些无效的用户。（对之前已经用其他收银台退款的用户无法过滤，只能过滤用这个版本退款的用户）
	
	8.客户端（UDO9.0.3.4）解屏后向收银台发送消息，IBA增加语音提示（需要在IBAConfig下面放一个unlock.wav语音文件）。
	
	9.调整上下班界面，增加账户购物、商品采购支出两项。
	
	当没有任何用户级别设置押金时，上下班界面不显示押金。 

**************************
*        V8.1.0.3        *
**************************
2010-12-30
  1.充值界面增加终端信息，结账界面增加终端信息，包时信息。

  2.刷卡时每个用户弹出一个界面，最后刷卡的在最上面。(功能取消)

  3.收银台设置：基本设置增加界面字体设置和登录界面显示“全场结账”按钮的设置，监控设置增加回车设置。

  4.修正充值退款界面不能显示包时信息的BUG.

  5.修正用户视图可能显示金额很大的BUG.

  6.充值，结账日志，如果在线的话增加终端信息。

**************************
*        V8.1.0.2        *
**************************
2010-12-21
   1.修正退款可能导致退款不退卡的问题。

   2.充值后关闭充值对话框。

   3.增加对银博网维的实名支持。

   4.如果中心不设实名不再默认为RZX。

**************************
*        V8.1.0.1        *
**************************
强制要求使用ISERVER 3.1.1.1，否则程序无法启动!

2010-12-16
   1.修改了刷卡记录界面（增加积分，余额，删除用户号）。

   2.修改操作界面（赠送为0不显示，删除用户号）。

   3.修改了消费历史界面。


2010-12-13

   1.增加充值和结账两个简单的对话框。

   2.增加刷卡或者扫描后动作的设置。（收银台设置）

     1）不弹出对话框。

     2）弹出充值退款对话框。

     3）会员弹出充值对话框，临时用户弹出结账对话框。

   3.取消激活，临时用户不从用户视图删除，只删除会员用户。
  
   4.任子行实名下支持：

     1）刷二代证自动激活实名卡
     2）刷二代证自动把实名卡帐号改成二代证，用于实名卡强制转二代证期间。

   5.在便捷通道输入卡号查询，如果只查到一条记录则不弹出对话框。

2010-12-9

   1.增加用户视图。所谓用户视图，就是指当前激活过和已经在线全部用户。用户视图对应数据库的activemember表。

     开户和刷卡（扫描）激活都会往用户视图插入一条数据，取消激活和结账退款都从用户视图删除一条数据。

     刷新时会从数据库重新载入数据到界面。
 

IBA里面开启了一个线程做定时往中心查询的任务：

   当用户视图里面的用上过机且6分钟没有收到ISERVER的上报，就往中心查一下这个用户的余额。
   
   如果用户还在线就更新此用户的ISERVER的上报为当前时间，更新用户账户信息，并写入数据库。

   如果已经离线，是会员则从用户视图删除，临时用户则看是否满足自动退款条件后做自动退款。



   2.为了支持用户视图，调整了所有实名的刷卡流程，实现从原来每次刷卡往中心查两次余额改只查一次，实现统一的刷卡流程。

   3.修改了开户界面的用户级别相关东西，取消开户的设置的默认用户级别。（需要测试各种情况的开户流程）

   4.修改了客户端设置界面，增加余额不足提示的设置和包时结束后执行动作的设置。

   5.增加闲时包月的模块，中心需要增加权限的设置。

   6.删除了除开户界面之外其他界面的扫描识别按钮，为了实现统一的刷卡流程。
  
   7.修改了充值退款界面的取消激活按钮和消费历史按钮，当用户在线时不显示取消激活按钮。

   8.修改左边栏用户信息的显示方式，增加了消费历史按钮。

需要测试下 8.0.4.0 所增加的功能。

**************************
*        V8.0.3.9        *
**************************
2010-11-25
    1.退款时，清除监控列表信息。

**************************
*        V8.0.3.8        *
**************************
2010-11-23
    1.清除离线且可用余额为0的用户信息。

    2.如果不需要激活的情况下，刷卡报余额。

**************************
*        V8.0.3.7        *
**************************
2010-11-20
    1.用户在客户端下机后清除监控列表上面的信息。（需要ISERVER 3.1.0.7 和 UDO 9.0.2.3以后版本同时使用）

2010-11-18
    1.当有人上班且在线用户不为0时，每一分记录一次监控的列表用户到IBAConfig文件夹下面的ActiveMembers.xml。
    
    2.断电全场结账：当执行全场结账时，会先判断ActiveMembers.xml文件在不在。如果在则使用该文件作为数据的来源，如果不存在则使用监控列表作为数据来源。
    
    如果收银台不能正常登录，可以通过登录界面的设置按钮，输入管理密码进入到门店建设设置，里面可以进入全场结账模块。
    
    执行全场结账后删除ActiveMembers.xml，同时保存数据到UploadInfo.dat文件并执行全场锁屏。全场结账修改了查询功能，功能类似快捷通道。
    
    3.取消刷新的功能。
    
    4.修改获取本机IP和MAC的办法。
    
    5.帮助菜单增加两个子菜单：“打印模板”和“语音模板”。

    6.修正商品销售选择商品时的一个会导致崩溃的BUG。

    7.修正中心升级的特殊情况下，连接中心得到异常数据但却误认为成功的BUG。

    8.修改入库模块，第一次选择商品会自动从中心同步商品信息。

    9.去除上下班模块的统计数据按钮，改为打开窗口自动执行统计数据。

2010-11-16
    1.充值退款上面的“总退金额”改成“可退金额”，退完款提示的”总退结额”改成“已退金额”。如果用户不可退，可退金额显示为空。退款后，界面上的金额不显示0.00，显示空。
    
    2.支持设置3个班次和2个班次，默认为3个班次。修改上下班和上下班设置模块。

    3.开户设置增加了检验身份证的选项。
    
    4.网盾实名模式下刷卡或者扫描后符合自动退款的，自动做退款处理，退款后自动弹出开户界面。

      这里会导致每次刷卡或者扫描会查两次余额。

2010-11-13
    1.修改接收超时为20秒，交班统计，终端消费查询，用户消费查询，库存查询，冲正查询接收超时为120秒。

2010-11-12
    1.修正入库不能选商品，要同时输入包和袋等BUG。
    
    2.可疑电脑的远程操作菜单全部禁用。
    
2010-11-10
    1.增加支持gintGlwPassword=3，强制使用过滤王密码，但密码为空时允许使用计费设置的密码开户。

    2.快捷通道输入4-5位数字时，严格按照后4-5位进行模糊查找。

    3.修正快捷通道输入4-5位数字时，如果没有找到会导致弹出充值对话框的BUG。
   
    4.取消班次控制。

    5.增加主备中心切换机制。

**************************
*        V8.0.3.5        *
**************************
2010-11-5
    1.修改入库的权限控制方式，由原来的显示控制改为现在的入库按钮控制。

    2.修改自定义包时模块。

**************************
*        V8.0.3.3        *
**************************
2010-10-18
    1.IBA监控界面的换机功能。（需要UDO新版本支持）
	换机的步骤判断。
	/*1）查询监控列表是否存在用户资料，不存在（防止监控有误）则查询终端是否有在线信息，没有就提示“用户不存在”。
	//2）临时用户才执行换机，会员提示"会员用户请在客户端执行自助换机！"。
	//3）离线状态执行换机登出，失败则不再执行下去，同时锁屏。（防止监控有误，如用户已经结账登出）
	//4）在线状态询问确定后：
		//*查询LastUserInfo表，失败则提示“没有计算机空余”。（ISERVER有误）
		//*锁屏。
		//*重新添加记录。
		//*双击选择计算机，只列出离线状态计算机，如果计算机已经有人占用（换机）并且虽然有人占用却没超过半小时没人上机
		//提示成功同时更新LastUserInfo表，关闭选择界面，否则提示重新选择。(如果查询不到有空闲机器，弹出提示，确定后自动退出)
		//*更新列表。
		//*写入操作日志。*/
	1）监控数据为空，不执行换机；但是离线在线以及一切异常状态均执行（挂机不允许换机）。
	//2）询问是否需要换机，确认后执行换机登出，登出失败则不再执行换机。（已经去除）
	3）执行锁屏，查询数据库，没有对应登入记录则仅执行锁屏操作，不再往下执行。
	4）再查询数据库，原有记录异常删除时重新添加。
	5）双击选择计算机，只列出离线状态计算机，如果计算机已经有人占用（换机）并且虽然有人占用却没超过15分钟没人上机 
	提示成功同时更新LastUserInfo表，关闭选择界面，否则提示重新选择，同时界面停留。(如果查询不到有空闲机器，弹出提示，确定后自动退出)
	6）更新列表。
	7）写入操作日志。
	
    2.全场结账作部分修改。
	1）添加“退款状态”栏目，同时“checkoutinfo”表也添加字段“returnState”,0标识“未退款”，1表示“已经退款”。
	2）如果数据库中“checkoutinfo”表没有字段“returnState”，登入时自动添加。
	3）没有提交数据或对应数据库有相应数据时，模块会罗列其中临时用户信息，并且初始选中第一项。
	4）“退款状态”栏目设计成下拉选择框，用户可以根据需要改变其状态。

     3.几处小地方修改。
	1）结账处用户结账后弹出查询框却无账号的问题，由于监控列表清空引起，现在修改后弹出查询框保存为结账前的用户账号。
	2）过滤王频繁出现“卡号不存在”的警告，要求不能弹出此提示，修改为写日志，格式为“NeedToCheckCard 检查错误！ + 错误码”。
	3）关于带有“确定取消”提示框的箭头异常反向问题，已经修改。（如充值退款界面退款时的提示对话框）
	4）修改上下班模块的盘点库存和统计数据的仓库统计查询机制， 能极大提高查询速度和查询稳定性。
	5）过滤王激活修改，根据中心判断是否需要激活实名系统来决定。
	6）工具栏去除若干按钮。
	7）主菜单栏的“系统配置”里的4个配置项如果没有权限，可以输入管理员密码来启动。
	8）添加工具栏动态显示快捷键功能。（需要更新BCGCBPRO71U.dll）
	9）包时转区，如果转包时时用户在线，先执行换机操作再进行转包时。

     4.在商品管理模块添加在线购物功能页。
	1）终端优先，如果终端为空，默认采用账号。
		*输入终端，则查找监控中的在线用户，没有则提示“终端没有用户在线，请重新输入！”。
		*同时输入终端跟账号，以终端为主。
		*输入终端或者账号并查询后，自动填充账号或终端，如果没有填充，会有提示说明本用户离线。
		*焦点初始在终端编辑框，焦点位于终端或者账号编辑框任意一处，回车即可执行查询。
	2）商品支持扫描枪或者点击选择按钮或者输入编号进行查询选择。
	3）商品备选界面支持“添加”和“删除”特定项功能，但是“取消”操作表示取消上一次的销售操作。
	4）非本网吧但在线的用户可能依然能够查询并操作，但不能结账。
	5）在线购物成功后会给客户端发送购物消息，余额不足会发送警告消息。

     5.约定型修改。
	1）结账/换机及锁屏删除lastuser表对应项纪录改为仅结账删除lastuser表对应项纪录。
	2）换机不再执行中心换机操作。（因为用户不在线后不能自动登入）
	3）过滤王实名刷卡后激活调整：根据中心判断是否需要激活实名系统来决定。
	4）任子行载入库卡死问题：改为外部条用。（暂未开放）
	5）销售模块扫描枪消息：调整后错误信息能够正常提示。
	6）刷新时如果网络正常就同步系统时间。
	7）过滤王强制密码去掉“会员且密码为空”不修改密码的限制。
	8）lastuser添加挂机状态，换机时如果将换终端处于挂机状态，则认为终端被占用，不执行换机，等待重新选择终端。
	9）关于扫描枪重复扫描的实现。
	10）监控结账功能支持所有用户状态，如果用户已经不在线，则中心会报错，不过应该可以接受。

     6.监控的分区域管理功能。
	1）“收银台配置”添加子页“监控设置”，原“IBA设置”中“余额不足限度”和“监控颜色”的“用户级别颜色”调整至此。
	2）分区显示管理以列表方式布列，打勾为显示，否则隐藏，如果项目太多会自动出现滚动条。
	3）配置文件段"MONITOR"添加区域子项显示值，添加方式是“PCClassType”+区域ID。
	4）监控中全部显示/只显示非离线和分区显示时并列的权限，两者的交集几位最后显示结果。

     7.自定义包时：
	1）添加在“包时模块”。（权限暂时与入库相同）
	2）自定义包时只能进行普通包时。
	3）需要查询“包时模块”后才能开放自定义包时。
	
**************************
*        V8.0.3.2      *
**************************
2010-10-8
    1.IBA登入界面从数据库(netbarcashier)读取操作员信息的修改。
	1）正常情况下从数据库读取操作员信息，如果数据库没有数据或链接失败，则从注册表读入。
	2）登入完成后如果注册表为空，则从数据库向注册表写入收银员信息。
	3）最后登入的用户仍然从注册表读取。
	（注意，如果收银员信息有误，请同步数据库,数据库要求版本在3.15以上）

    2.全场结账功能。
	1）添加独立模块，必须输入管理员密码才能操作。
	2）断网后，点击“全场结账”，会员用户只进行结账，临时用户退款。
		*退款临时用户信息罗列于列表中，同时监控界面的所有具有信息的用户设置为离线状态。
		*所有用户的信息写入本地数据库表checkoutinfo。
		*输入查询的终端或者账号回车或者点击查询，列表定位选中对应信息。
	3）网络重新连接时，点击“联网后处理”，所有用户结账到上次断网时间，另外临时用户还会执行中心退款操作。
		*退款成功后，列表删除对应项。
		*执行完成后删除数据库中保存的数据。
		*退款操作包括写退款记录和退款日志。
	4）退款金额不包括押金和工本费。
	5）保存的信息以点击“全场结账”时为主。
	6）对退款金额进行舍入处理，只在列表显示的时候进行舍入，保存依然采用精确数据。
		*从netbatinfo中根据网吧标号查询舍入方式。
		*舍入方式共有6种，具体调试可以用全场结账后的退款金额跟充值退款界面查询的结果比较即可。
	7）临时用户信息查询，只能通过终端或上网账号进行查询，其中同时存在时终端优先级较高。
		*输入后回车即可执行查询。
		*查询到的结果选中显示。
	8）收银台登入、查询余额和检验卡号有效性后均会检验网络是否连接，连接正常时会自动进行中心断网数据的提交成功后信息写入操作日志。
		*如果在全场结账界面提交数据成功，则不再进行自动提交。
		*提交仅仅进行一次。

    3.几处改动。
	1）客户端配置里的功能显示做了某些修改。
	2）入库模块的出现需要中心配置权限，不能通过输入管理员密码来显示并使用该模块。
	3）舍入的操作凡是的调试软件可以在WK上下载得到。
	4）由于中心升级，现在重新修改日志和打印密码的显隐。
		*开户或充值时，会员开户/过滤王强制密码就不显示密码，其他情况显示。
		*开户时，过滤王强制密码就打印密码为*****，充值时会员开户/过滤王强制密码就打印密码为*****，其他情况正常打印。
	5）开户模块为了避免输入的金额传递不准确，对金额小数后第3位进行四舍五入处理，反之出现1分钱误差。
	6）所有账户合计均加上上网预留金额。（预扣冻结金额中未消费的金额）

    4.工具栏和弹出菜单的手动刷新功能断网时处弹出“网络连接失败！”，不再执行刷新操作，不过网络正常时没影响。

    5.添加后台控制参数gintMustScan=2，用以隐藏所有界面上的“扫描证件”功能。
	1）gintMustScan=0为不扫描， = 1是强制扫描，此时开户需验证身份证。
	2）gintMustScan=2的优先级高于配置文件的ScanReco.ini的[SCAN_LOAD]项LOAD_ID的控制功能。（LOAD_ID = 0是禁止，1为使能）

**************************
*        V8.0.3.1      *
**************************
2010-9-29
    1.用户自带卡功能。
	1）默认不勾选用户自带卡功能。
	2）启用用户自带卡后不考虑押金和工本费，同时操作日志和发声不再出现押金部分。
	3）本功能适用所有级别用户。
	4）收银台配置-开户设置处添加“显示用户自带卡功能”。
	5）在勾选“用户自带卡”后，押金不显示。

    2.监控表用户离线但有用户资料还能使用双击查询用户信息。
	（测试时可以在不同用户状态下调试）

    3.实名刷卡时如果 账号不能开户（一般是指“用户或卡号已经作废！”）会弹出提示对话框，同时不再弹出注册界面。
	（因为也无法用此账号注册了）

**************************
*        V8.0.2.8      *
**************************
2010-9-10
    1.添加“消费历史”日志。
         1）在充值退款模块的退款操作后，自动刷新显示该用户的交易历史，便于收银员直观核实退款。
         2）退款关联交易历史查询时间限制在24小时内。
	 3）如果需要了解更长时间的消费历史，可双击操作跳转消费查询窗口。

    2.修改账号的功能。
	1）输入牛盾账号或IC卡账号后点击查询，后输入新账号就可以修改账号。
	2）如果输入印刷卡号，可能会提示“此卡未注册！”，标识本卡号存在，但没有任何用户资料。（新卡）

    3.实名强制密码gintGlwPassword=2的不打印密码，不显示密码于日志。
	1）涉及模块是充值退款和开户，只要是开户和充值，开户包时，充值包时功能。
	2）日志是不再显示密码，打印时的密码统一成“*****”。

    4.支持从主菜单项“实名系统”调出过滤王实名控制台。

    5.消费查询模块修改。
	1）输入上网账号，如果该账号有用户存在，就直接查询该用户；
	如果该账号所有用户都已退款，则查询本地用户信息（member表），弹出对话框要求选择用户，双击或选中确定都可以。
	2）输入名字或者证件只能查询未退款的用户，如果符合条件的用户超过1个，就弹出对话框要求选择。
	3）退款日志里双击指令跳转到消费查询界面，且仅仅会查询当前退款用户的用户信息，
	但这仅仅查询一次，如果再次单击查询，会要求选择具体用户再查询。
	4）如果查询弹出框的记录数目为空，就自动关闭，表面上几乎没法看到其创建和销毁过程。
	（如果具有相同用户号，也会一并罗列下来）

    6.关于充值卡充值的“读取充值卡”的越界问题。
	1）修改后能够遍历开出充值卡的所有，过去会漏掉第一个，具体文件保存在IBAConfig\cards.txt。
	2）修改后读取卡的最后一个不再抛出异常。

    7.强制过滤王实名参数为2时，充值及开户模块不再显示密码。

    8.添加任子行卡注销实名功能。

    9.监控的在线包时修改。
	1）监控界面添加“在线包时”右键菜单。
	2）权限为上班，具有包时权限且只对生日，黑户，VIP，挂机，余额不多，在线状态的用户开放，任意不符合者本功能变灰。
	3）该功能会弹出“包时”模块并对该客户端用户作自动查询操作。

    10.中心参数修改。
	1）中心添加参数 gintDisallowUnlock， 1为不允许解屏，0为允许解屏。
	i）IBA登入成功后从中心取参数（之前会先从数据库取），不允许时“客户端配置”不显示“维护时间”设置项，此时数据库写入维护时间3分钟。
	ii）IBA登录成功后会更新SystemConfig 表 DisallowUnlock 记录的keyvalue1的值。
	iii）DisallowUnlock 的状态默认为0，如果中心没设置控制参数，默认0。

	2）客户端设置模块增加“允许客户端包时”和“允许客户端挂机”两个勾选项
	i）分别对应SystemConfig的AllowBundleTime和AllowSuspend记录。
	ii）如果做出修改，并且确定后才会存入数据库，数据库为空时采用下面的默认允许值。
	iii）初始默认值全部设定为选中，客户端也设定默认为全部选中。
	
	3）如果中心返回的gintGlwPassword为2，更新SystemConfig的AllowChangePwd的keyvalue1的值为0，其他为1。
	更新在IBA登入成功后进行。

    11.某网吧出现的不知名错误提示框问题：
	是由于没有安装声卡及驱动引起，现在添加收银台捕获并提示“放音失败！请确认该电脑是否正确安装了声卡和语音包！”。

    12.合并账户模块添加在菜单“用户管理”部分。
	1）只有会员用户能够执行合并。
	2）合并后被合并用户退款销毁。
	3）如果具有权限，正常使用，否则必须输入管理员密码。
	4）初始焦点在主账户，回车或点击后查询；继而焦点落于被合并账户，回车或点击后查询；最后要求输入密码，焦点回到主账户。

    13.充值退款模块的在线包时功能。
	1）只支持正常本区域包时，不支持转包时、提前包时和取消包时。
	2）在线状态下“选择包时”依然有效，不过可选择的包时策略只显示符合条件的，其他不再显示。
	3）选择策略并双击或者选中回车/确定后，发送消息，延时2秒后重新查询并弹出操作结果。
	4）在线时“取消包时”依然变灰。
	（这里的选择包时策略其实已经限制了用户不可进行提前包时和转包时，界面限制在线取消包时）

    14.新增过滤王参数gintGlwPassword=2,（gintGlwPassword=1功能不变；）
	作用：强制使用过滤王密码，不打印，不显示，禁止客户端修改密码功能，同时自动检验修改密码；
	1）用户刷卡时，传过来的密码和中心返回的密码不一致时，程序自动修改用户中心密码为过滤王传过来的密码；
	2）检验密码时间在过滤王第一次发送消息并正确查询中心时；
	3）如果过滤王密码为空，弹出提示：“过滤王密码为空，请检查实名密码设置是否正确！”并且不做修改；
	4）如果用户为会员且中心返回密码为空，暂不做处理（中心未升级前会员传过来的密码为空）。
	5）开户时如果过滤王密码为空，禁止开户并弹出提示。

    15.注销实名信息模块的的修改。（防止收银员作弊）
	1）只有已经退款的用户才能注销实名；
	2）如果卡号依然有效，弹出提示“请先执行退款！”，再弹出充值退款模块。

    16.IBA收银台刷卡判断机制调整之强制使用身份证作为上网账号。（只支持过滤王）
	1）gintAutoMatchIDCard = 2时作为强制使用身份证作为上网账号的标志。
	2）只有使用2代身份证刷卡才有效，其他实名卡及一代身份证不进行操作。
	3）本功能使用所有用户，执行在过滤王的关户消息中进行。
	4）启用本功能，用户使用身份证开户、用户账号不是身份证，采用二代身份证刷卡时将会自动修改以身份证作为账号。

    17.入库模块：
	1）添加在商品管理模块。
	2）每次入库的商品需要点击“选择商品”，双击后得到商品信息，同时输入入库数目和采购价格。
	3）采购价格初始时是最高采购单价，默认采用小单位，采购数量必须输入整型数字，添加时会对此进行转换，非数字时会存入0。
	4）采购价格大于最高采购价格或者=0、采购数量=0均不能入库。
	5）上下班时的“其他支出”自动计算出上班为止的入库金额，下班时清空此数目。（写入系统配置数据库）
	6）“选择商品”的信息如果与实际设定存在差异，请同步数据库。
	7）焦点设置，初始焦点在商品编码位置，回车或扫描后跳转到入库数量编辑框，添加到库存后回到商品编码位置。（删除或入库后也会回到编码处）
	8）输入限制，如果入库数量多次输入非法，蓝屏，切换焦点即可恢复。
	9）唯一单位时输入的库存数值， 大小单位时输入库存不能全为0；单价都必须大于0。
	10）如果输入的单价存在非法字符，添加时会进行前端截取转换。
	11）支持扫描枪，如果输入商品编号，回车查询；如果输入后几位，是模糊匹配，多于一个时要求选择并弹出列表。

    18.监控处的结账操作在登出后会查询该用户信息，在用户存在包时状态时才在进行退包时操作。（以免出错）

    19.添加允许编辑“其他支出项”功能。
	1）添加于“收银台配置”-“上下班”，默认值为1，即允许编辑。
	2）注意其优先级低于“启用动态备用金”和“显示交班信息”。

**************************
*        V8.0.2.4      *
**************************
2010-9-1
    1.充值退款界面的打印操作添加打印密码。
	1）必须下载正常充值打印模板和充值包时打印模板。
	2）只能对临时用户打印，非普通用户打印密码为空。

    2.退款金额显示：
	1）收银台配置的充值退款页添加“显示可退金额”。
	2）配置文件段[Credit]添加[ShowReturnMoneyOnline]，默认为0，即不显示。
	3）非在线用户显示方式不变，默认下在线用户不显示“可退金额”。
	4）配置“显示可退金额”选中，则在线用户显示“可退金额”。

    3.批量结账模块。
	1）模块界面为非模态界面，不堵塞当前线程。
	2）查询可以选择查询的在线用户类型，分为“全部”、“未包时”和“临时用户”，默认项为“全部”在线用户。
	3）查询搜索数据库“activemember”和“member”。
	4）当焦点在组合框时，回车能自动查询，esc退出界面。
	5）菜单点击后输入管理员密码才能进入该模块。

    4.客户端配置项添加“客户端显示使用时间”。

    5.批量退款模块调整。
	1）批量退款模块改成非模态方式。
	2）批量退款模块改为批量结账，并在交班模块添加“批量结账”。
	3）交班模块的批量结账必须是启用动态备用金的时候才能显示，其他时间隐藏。
	4）交班模块的批量结账功能的权限跟菜单项一致，即必须有充值退款权限，如果没有，则必须输入管理员密码。

     6.一处小调整，输出窗口全部改成网格方式。
	1）操作日志的退款操作双击后弹出消费查询模块并传递账号参数，其他不变。
	2）所有操作后的日志账号规范化，大于9位的不变，小于10位的前面加0补成10位。

     7.动态备用金修改保存方式。
	1）配置文件添加“duty”的子项“NynamicReverseMoney”。
	2）动态配用金改成配置文件保存，如果读取到结果是0（配置默认的数值），就从数据库读取。

     8.收银台配置的几处改动。
	1）基本配置页的“弹出确认提示对话框”放到充值退款配置页，更名为“允许充值退款操作时弹出确认提示对话框”。
	2）添加包时状态监控的颜色设置，配置项为“Color”-“BundTime”,默认为黑色。
	3）包时颜色配置优先于其他配置。

     9.每次强行登出或者锁屏操作都会修改登入登出表。

**************************
*        V8.0.2.3      *
**************************
2010-8-20
    1.收银台屏蔽交班金额功能。
	1）收银台配置-》“上下班”页添加项“显示交班信息”。
	2）收银台配置文件添加ShiftSet->ShowShiftTotal子项。
	3）配置打钩后交班信息隐藏，同时交班查询功能禁止，交班打印查询功能禁止。

    2.押金考虑：
	1）开户成功后在日志栏添加押金提示。（如果有中心配置且押金不为0）
	2）开户界面的充值金额必须大于等于押金才能够开户。
	3）包时时的充值金额必须大于= 押金+包时金额，开户日志提示信息的充值金额改为包时前的数目。
	4）交班界面添加本班次的总押金，数目计算到本班次的现金收入中。
	5）充值界面查询出查询子项添加“押金”。
	6）日志可能做出调整，押金项只有配置而且数目不为0才提示。
	7）交款查询，操作查询针对押金做出若干调整。

    3.门店建设里的"检验"成功后会重启IServer(3.1.0.1及以上)。

    4.包时模块支持在线包时。（IServer和客户端未完成）

    5.过滤王实名刷身份证时会根据中心参数gintAutoMatchIDCard的配置做不同的动作。
    
    IBA增加支持中心参数gIntAutoMatchIDCard
    
	0）二代证、实名卡不关联，各用各的帐号，即原先的模式
	1）刷二代证自动激活实名卡
	2）刷二代证自动把实名卡帐号改成二代证，用于实名卡强制转二代证期间（未做，等中心修改后才能做）

    6.实名系统菜单增加扫描证件功能子菜单。

   
**************************
*        V8.0.2.1      *
**************************
2010-8-12
   1.操作记录调整。
	1）列表子项分割拆解。
	2）双击弹出充值退款模块。
	3）所支持的操作仅包括：充值、退款、开户充值、开户充值且包时。

   2.充值改成“充值”、“充值并打印”两个按钮。
	1）“充值并打印”具有“充值”原有的功能。
	2）只有点击“充值并打印”才会执行打印的操作，同时，“重复打印功能”才会继而显示，“充值”则不具备此功能。
	3）“重复打印功能”功能调整，现在充值包时也能重复打印，同时，从账户里扣除包时金额的方式下不能打印了。
	4）“充值并打印”具备“充值”按钮的一切功能和行为。

   3.开户金额。
	1）在收银台设置的“开户设置”里添加设置项，可以输入默认金额，保存到配置文件。
	2）设置的金额不可以输入小数，输入的小数会强制转成整数。
	3）开卡成功后自动关闭窗口, 开户密码显示在日志栏。

   5.充值退款模块增加自动判断用户是否允许退款，不允许退款按钮禁用。
	注意：可以退款的条件是有用户存在并且该用户允许退款，此判断由中心决定。

   6.IBA快速通道。（参考上次版本第6说明）
	1）输入短号(1-5位)按终端查找。
	2）终端找不到且短号为4-5位再按帐号到本地库查找，若找到再用本地的完整帐号到中心查询
	（此处是模糊匹配，弹出所有历史上的开户资料，包括已经退款的，要求选择需要的）。

   6.充值退款模块增加自动判断是否允许退款，不允许退款按钮禁用。
	（此设置由中心决定，一般是会员不允许退款，而临时用户允许退款，不过并不绝对）

   7.由收银台配置设置回车动作。
	1）充值金额非空，此时回车必定是充值操作。（Ctrl + Enter是“充值打印操作”）
	2）充值金额为空，且收银台配置为“关闭窗体”，则回车执行关闭操作；收银台配置为“执行退款”，则回车执行退款。
	3）当允许退款时，即使配置成退款操作，回车依然不作任何动作。

   8.客户端配置添加“允许临时用户自助换机”和“允许会员用户自助换机”项，
	修改数据库systemconfig.SelfChangeComputer 中keyvalue1,keyvalue2。

   9.几处修改。
	1）临时用户充值后操作日志显示密码，这里的临时用户的定义由中心配置来决定。
	2）只有用户在线同时用户被中心允许远程下机的情况下才可以显示“远程下机”的按钮。
	3）状态栏的包时用户统计所成“包时用户”，包括累计封顶和足额预扣的总数目。
	4）收银台配置调整，添加2个子页，分别是“上下班”和“充值退款”。
	5）充值退款加添快捷键Ctrl + Enter 作为“充值打印”的单击响应。
	6）退款时如果用户不允许下机，则锁屏。
	7）操作日志添加金额栏。（对充值时充值金额，开户是开户金额，退款是原账户余额）
	8）开户配置金额设为0时，默认开户不设置默认金额。

    10.过滤王循环卡自动退款再开户刷两次卡改成一次。

    12.过滤王二代证先按帐号查找，找不到再按身份证号查找。

    13.开户模块自动生成账号。
	1）在中心配置使用临时用户参数gintTempMember=1后使能自动生成用户资料，包括账号。
	2）保存在数据库systemconfig里德AutoNetId里。
	3）账号有网吧ID+六位组成，从1开始，大于999999时返回1，空位用0补齐。
	4）自动生成的用户名是“普通用户”，证件类型是与账号雷同。
	5）每次单击“临时用户”后账号递增1，可以避免不能开户的情况。（账号已经注册）

**************************
*        V8.0.1.9        *
**************************
2010-8-2
   1.充值退款模块的包时信息显示处的“包时类型”修改成“剩余时间”。
	1）无论是查询还是选择包时都能智能的计算剩余的时间。
	2）选择时剩余时间计算在区间外则显示为全时长，区间内如果是全区间包时，则小于=时长，部分区间包时则视计算而定。
	3）查询时剩余时间计算在区间前显示则为全时长，区间后则为0，区间之间则是结束时间-当前时间。
	（查询的结束时间不一定是区间结束时间）
  
   2.批量退款功能修改。
	1）查询的时间大大增加，但退款的时间会相应的减少。
	2）子项添加“消费状态”和“自动退款”，删除“收银员”。
	注意：“消费状态”：未消费专门指账户从来没有上线记录，已消费仅指账户曾经上线；
	      “自动退款”：是，则满足自动退款条件，否，则不满足自动退款条件。
	（如果查询成功，但退款操作由于某些原因失败，则退款后此“消费状态”和“自动退款”的栏目上有可能为空，
	此时再次点击“查询”按钮即可，切记，切记！）
	3）添加列表中选中子项双击时弹出“充值退款界面”。

   3.开户的年龄限制，具体是在“收银台配置”中选择年龄限制，只能选择18/或16还有‘无’
	1）开户时的年龄采用虚年龄计算，未成年的弹出提示。
	2）添加配置文件子项“Register”-“RegisterAge”保存开户年龄。
	3）选择无后默认未成年的年龄是0，即不再提示。

   4.开户时的实名密码问题。(本设置适用所有的实名类型)
	1）中心控制参数添加“gintGlwPassword”，为1标识强制采用实名密码（刷卡时才有用）， 0为采用默认收银台密码。
	2）中心控制参数“gintGlwPassword=1”且实名密码非空时，采用实名强制密码，否则，采用默认收银台密码。

   5.状态栏中统计包时用户付费类型数目的功能。
	1）包时付费类型包括普通计费，累计封顶和足额预扣。
	2）本功能只是对此类用户才进行统计，如VIP、在线、生日、余额不多、黑户、挂机。
	3）其中的百分率只针对总机数。

   6.快速通道终端查找。
	1）除规定格式外，开始是字母的，按终端查找，不是字母的，2-6位按终端查找，6-？按账号查找。
	2）终端查找时寻找第一个有此字串的终端号，并且是模糊匹配。
	3）通道规格说明中有此格式规定的说明添加。

   7.充值退款模块的取消包时功能。
	1）在线情况下，包时按钮变灰。
	2）已经包时情况下，包时按钮显示“取消包时”;没有包时情况下，包时按钮显示“选择包时”。

   8.充值退款模块的充值包时智能处理。
	1）收银台设置增加“包时前是否需要充值”参数，
	配置文件添加段+字段“Credit”[“CreditBeforeBundTime”],0为禁止，1为使能。
	2）在线时包时功能禁止使用，不过按钮文字仍然会随包时状态改变。
	2）当参数设成使能时，选择包后，在充值金额编辑框内自动填写包时金额，充值的同时进行包时。
	此时会对金额进行检验，不过如果充值失败，包时就不会执行。
	3）当参数禁止时，余额足够，则充值金额为空，直接从账户中扣去包时金额;
	(此时选择包时后自动完成包时操作)
	余额不足，弹出提示“余额不足，请先充值！”，充值金额填入所选包时金额，此时先充值后包时;
	但如果此时修改充值金额，如果充值金额+余额大于=包时费用，此时先充值后包时;
	如果充值金额+余额小于包时费用，此时弹出提示“余额不足，请先充值！”，不执行任何操作。
	4）关于发声和打印小票，充值包时的发声是充值包时联合，单纯包时就只发声包时，
	打印小票时如果单纯包时，打印的充值金额为0。（即除了单独充值外，有包时情况下一直使用充值包时方式打印）
	5）充值的情况下所输入的充值金额必须大于包时金额，否则不执行操作。

    9.开户未消费模块。
	1）模块暂时放置在查询菜单下，查询的开始时间是前一天，结束时间是后一天，并且支持手动调整时间。
	2）查询的未消费的用户专门指非会员用户，账号在设定时间段内开户并且结束时间前没有上机历史以及不是在线状态。
	3）查询的非会员用户由收银台自动识别，一般是中心认为的非会员用户。
	4）涉及的在线记录表是Activemember,历史记录表是consume。
	5）双击弹出充值退款界面同时传递账号。

    10.开户模块的实名传递用户级别不再区分，一致采用默认级别。

**************************
*        V8.0.1.8        *
**************************
2010-7-30
   1.实名功能修改，详细情问张工。

   2.鉴于开户及充值包时可能出现的情况，做出修改，以保证更稳定操作，
	详细修改涉及开户模块，充值模块，公用的弹出对话框。

   3.关于批量退款时偶尔出现的被退用户仍然查询到的问题，初步认为是memberid重复使用造成，
	添加classid = 1且member.classid = cardopen.classid条件做进一步的限制。
	1）批量退款的不退款情况添加一个，为“新开的卡”不退。

   4.L2ToolKit.dll需要更新。

   5.添加临时卡注销功能。
	1）位置在主菜单的“实名系统”-“注销临时卡”。
	2）卡号非空时直接给实名系统发送消息。

   6.监控界面上的右键菜单“换机”功能做出调整和“结账”功能除登出外还执行取消包时的操作。
	具体说明如下：
	1）原属的“离线状态”下可以“登出用户”功能不变。
	2）“在线”“挂起”“生日”“VIP”“黑户”“余额不多”“黑客”状态下“换机”功能均有效，此情况下执行远程下机的操作。

**************************
*        V8.0.1.7        *
**************************
2010-7-16
   1.充值界面的包时功能。
	  添加包时id选择按钮，包时信息栏，包时信息栏在选择包时数据后实时反映包时信息，查询时包时的用户也会显示。
          应用情况如下：
          1）开始时全灰，必须在查询后才能操作，如果已经包时，不能进行包时了；修改上网号，重新回到初始状态。
          2）“用户在线”的情况下不执行包时操作，同时，包时按钮也会变灰。
	  3）打印模板添加充值包时功能，名为“CreditrAndBundleTime.txt”，如果执行充值并包时操作，则打印此模板样式，只是充值，则打印冲值样式。
	  4）发声配置文件添加“CreditResultWithBundTime”，发声时如果已经包时或包时不使能，发声
              采用普通充值方式，否则，采用充值包时方式。		
	  5）包时选择后，把当前选择的包时金额自动更新到充值栏（此金额为空时），此时充值后才会执行包时操作。
          6）有包时的情况下，充值包时后乃激活卡，可从报声听出。
	  7）重复打印时不会再对充值且包时的信息重复打印，此时只是对充值信息打印。
         （因为包时充值后一般会进行查询，此时无法区分究竟是已经包时后的充值还是同时充值包时后的查询）

    2.开户界面的根据用户名及用户证件号码的反查功能。
	  因为本处是为开户做准备，因此不支持根据 上网账号 的查询，因为这表明卡号正在使用，不符合要求。
	  1）在用户名或证件号码任意一处/两处输入，回车或点击查询按钮，则开始查询（较慢）。
	  2）双击选中的记录或选中记录后按回车，即可关闭对话框并且将对应信息选入到卡户界面，点X或按ESC也会关闭，但不会有信息更新。

    3.断网模式运行：
          1）在“门店设置”中使能断网，状态结果保存到数据库，改变断网与否的状态后，系统强行退出。
	  2）断网状态下用户默认为“admin”,密码“admin”，本地模式下只有用户“admin”
	   同时清除注册表项"netbarInfo"，因此如果恢复远程中心模式，用户要选择使用的登入用户。
	  3）断网数据库必须先同步，因此，在运行断网数据库前，历史上必须运行正常模式一次。
	  4）断网模式下仅支持“充值退款”， “开户”，“包时”，“修改密码”，所有的“用户查询”。
	（批量退款和座位图也开放，因为座位图没在中心设置过权限，而批量退款权限和“充值退款”相同）。
	  5）进行架构调整，把断网的收银员和普通方式收银员分开处理，断网下不再对注册表进行修改，只有正常模式下才可以。

    4.正常下机失败下的异常下机：
	  描述：如果某些原因导致正常下机失败，弹出异常下机对话框，点击“确定”/回车后异常下机（后台执行chechout操作）。

    5.开户或充值完成后，金钱输入框空的时候，按回车键自动关闭窗口。
	  描述：必须是焦点在输入框的时候才能按回车执行关闭的功能。

    6.批量关机，开机，重启功能。（监控列表的多选功能）
         描述：关机、重启功能向除“离线”和“可疑电脑”外的所有用户开放，开机则反其道而行。
	 1）选择中以“小三角”所在的行的状态来最终决定更新菜单的功能。
	 2)执行某功能时进行自动的过滤，只对符合条件的记录执行操作，但允许选择不符合条件的记录。

    7.版本汇报机制调整。
	1、收银台、iserver汇报实际的机器名（后8位）作为终端号（容易区分有没有在安装冗余的版本）。
	2、收银台、iserver每次启动时都汇报版本（原来为有变化才汇报），中心记录最新重启的时间，便于查验问题。

    8.包时策略架构调整及开户模块调整。
     	1）包时的策略在登入的时候从中心读入，从而极大提高包时策略选择的速度。
	2）开户模块的包时信息栏改成不可编辑的下拉，可以通过下拉或按钮分别进行选择。
	3）包时策略选择添加“无”策略选择。

    9.取消客户端设置里的安装密码。

    10.商品赠送模块（调试时可以用商品查询来验证）。
	注：商品查询处作修改，赠送和积分兑换的“购买方式”、“首项”已经重新分开处理显示。

    11.盘点库存功能。
	1）每次点击“盘点库存”后自动同步。
	2）刷新分类时不同步，同时通过点击“退出”\回车（焦点在按钮上才可以）退出本界面。
	3）打印商品功能打印库存情况，只支持pos打印机。

    12.输入密码进行权限开放。
	1）管理密码在“门店管理”模块中进行设置。
	2）本地模式下本功能无效，采用原来的方式进行。
	3）远程中心模式下，除销售模块外，所有已经禁止的功能呈现高亮显示，点击后，如果中心没有设置权限，则弹出密码		
	输入框输入密码，验证通过后进入模块，而且只能使用一次；如果中心开放本权限，则直接进入模块。
	4）本功能只是对充值、开户、冲正、升级、包时、批量退款、充值卡充值、修改密码、修改资料及修改账号有效。

     13. 几处小改动：
	1)修改中心解析、连接、发送，连接时间，分别为5、5、10、120秒。
	2)同时在监控界面的右键“结账”下机操作中添加取消包时操作。
	3)充值退款及注册界面的回车设定修改成只要金额为空就能退出界面。
	4）充值退款添加“职销激活”的功能。
	5）充值退款界面上有包时的情况下，提示信息的字体会显示红色。

     14.客户端消息功能模块。
	1）增加客户端消息接受的记录提示，在输出界面可见，默认上班时为本班次消息，下班为整天消息。
	2）增加客户端消息查询的界面模块，查询的初始时间是上班时为本班次消息，下班为整天消息。
	3）双击消息记录能弹出消息发送的界面，发送给对应客户端消息(消息记录及详细查询都有)。

**************************
*        V8.0.1.6        *
**************************
2010-6-30
  1.座位编辑设置及监控功能,必须在IBACONFIG文件夹里添加文件STATUA.BMP才会有椅子图，否则默认绘画黑方块。
    描述：系统设置->收银台设置，里面添加座位设置页，设置座位图路径，保存到IBACONFIG\\IBA.ini里[SeatPlan]项。
	  收银台->座位视图点击可以显示座位视图，关闭时可使用视图的小X。
	  系统设置->座位操作有功能4个，分别为锁定，编辑，保存，载入。
          应用情况如下：
          1）锁定时只能查看座位状态（左键单击），右键显示整体图（根据实际窗体拉伸）还是正常的滚动图，并且根据状态	
	     给座椅进行颜色及形状的改变。
          2）编辑时左键，空白处会添加座椅，点击座椅时不会添加，按下并拖动，可以移动座椅（黑块用来定位）。右键
	     时空白处只能触发刷新命令，右击座椅删除和旋转的功能均能触发。
	  3）注意哦，必须保存才能把修改结果保留，载入是载入上一次的结果，当然，初始显示也会载入上次保留的结果。
	  4）用户显示座位图后自动记录（每次均显示），关闭视图时才取消显示模式，此标志写入IBACONFIG\\IBA.ini里	  	
	     [SeatPlan]项。		
	  5）添加终端的对话框的ID可以自动匹配IP，并且已经禁止IP的选择（禁用反查ID的接口）。
          6）添加终端到没有时弹出提示，保存功能合并到锁定功能里，点击锁定时同时会保存数据。

   2.快捷通道输入账号弹出充值退款界面后不会再自动激活，只有在刷卡或扫描证件的情况下才会激活。

   3.临时用户批量退款功能。
	1）查询只是针对限定时间内所开户的所有临时用户。
	并且默认起始时间是取当前时间的上一天，结束时间为当前时间。
	2）批量退款功能设置提问对话框，只有确定才会触发退款事件。
	退款成功，会提示成功退款的数目，如果没有符合条件或全部都已经退款，提示没有用户需要退款。
	3）回车问题。当焦点在时间设置框或查询按钮上时，按回车才会触发查询功能。
	4）批量退款时会逐个上网号查询中心，根据余额及自动退款的条件进行退款，同时，还会退实名信息。
        5）自动退款后重新查询，已经退款的用户排除，并且在界面上显示结果。
	6）批量退款的条件和自动退款类似，是普通用户，余额为0，不在线，不包时，时间超出自动退款时间时才执行。

   4.在收银台设置-》基本设置里添加自动打印交班表按钮。此标志IBACONFIG\\IBA.ini里的
	[shiftset]段[printshiftreport]项。

   5.实名纠正信息功能方面，弹出对话框时就确定更新中心不一致的实名数据完毕，只待用户确认而已，
    对话框的标题栏关闭按钮及CANCEL/ESC等快捷键处理已经屏蔽，必须确认才能退出界面。

   6.用户消费查询列表中添加上网账号的子项,相同证件号码的情况下只是取第一条记录，所有LIST的双击消息只有上班才有效。

   7.登录框中文用户支持。

   8.临时用户批量退款功能上班时才有效，座位视图显示则是上下班都有效，下班状态下，所有功能禁止，但是终端监控和座位图可见，只是不可操作。

   9.过去默认的班次ID为0，修改为1，强制中心验证班次及上下班信息，防止出现下班有交易的情况。

   10.交班的数额4舍五入，防止出现由于计算机浮点型的误差引起的结算不平衡现象。

**************************
*        V8.0.1.5        *
**************************
2010-6-22
  1.增加升级数据库IDREDER表。

  2.修改客户端设置模块，根据中心返回的软件类型隐藏相应的设置。

  3.语音播放改进，对小数部分为0的金额情况下只发声报整数部分。

  4.支持打印后8位账号，需要在打印模板里面把[cardserialnumber]改为[netid]。

  5.监控视窗下的右键截屏操作改进，现在只针对该操作的收银台才会接受截屏信息及日志信息(对多收银台的情况下)。

**************************
*        V8.0.1.4        *
**************************
2010-6-8
    1.礼品兑换功能
    描述：由中心标志控制其权限,加密号曰：“IBAP_USEPOINT”,默认为禁止。
          应用显示情况：
          1）查询后且用户存在才能进行礼品修改。
          2）输入的礼品数目及所换礼品>0才能兑换成功。
	  3）菜单栏“用户设置”及工具栏中有对应命令添加，菜单栏中快捷键ALT+D/F11。

	
**************************
*        V8.0.1.3        *
**************************
2010-6-1
  1.便捷路径添加整界面的消息拦截，使得除回车，ALT+“*”（*为任意按键）之外的键盘消息都集中到便捷路径上。

  2.添加注册表检校。
    描述：注册表被破坏的情况下依然能够上下班，下班前写注册表，失败不管，上班时检验注册表。
          上班条件：点击上班时，检测注册表的上次上班时间，上班用户，上班班次从中心读取。
	  1）上班班次！=0，则必定不能上班。
	  2）上班时间在上次7天后，必定能上班。
          3）如果中心显示下班，但注册表有用户在线，则重新更新注册表。

  3.动态备用金功能
    描述：从IBA设置启用动态备用金功能，写入IBAConfig的DynamicReserve = 1来标识启用进行保存，下班时，下一班备用金存	    
	入数据库。
          “动态备用金”显示情况：
          1）上班下，点击“统计数据”，上班信息中显示上一班保存的的“备用金”.
		如果是“静态”，显示上班时的输入，如果是“动态”，显示上次下班的数据在数据库shifttotal的				
		remainamount来保存金额。
          2）上班时，“静态”可输入，“动态”禁止输入;“静态”初始值为0，”动态“值为上次数据库保存的数值。
	  3）“上缴金额”和“本班备用金”都是在“启用备用金”后才会可见。

   4.实名卡用户资料检验功能
    描述：刷卡进行实名时，进行用户资料检验，由中心标志控制。“NoModifyMember = 1”为禁用自动检验功能，但手动启用“修改资料”的菜单命令。
          检验显示情况：
          1）检验用户名，证件级别，证件号码，用户级别不进行匹配，因为无法统一。
          2）支持“任子行”，“过滤王”，但网盾不支持，其中“过滤王”对“学生证”可能会认为是“其他证件”。
	  3）弹出的用户资料对比框后必须输入密码才能进行修改，修改不成功会停留在界面上，点“X”才能退出，成功则弹出		     
	   对话框后自动退出。	
	  4）此检验对话框只是对刷卡的情况下才会弹出。

    5.实名卡普通用户自动退款功能
      描述：退款条件跟普通用户自动退款雷同，可参考自动退款的说明。

**************************
*        V8.0.1.2        *
**************************
2010-5-27
  1.网络实名功能初步添加，支持任子行，网盾，过滤王,且保证IBATemp路径存在才执行实名功能。

  2.充值退款界面添加用户查询功能，打开用户消费界面后，充值退款界面消失。

  3.添加用户级别颜色监控。
    描述：用户级别颜色监控的颜色参数根据不同网吧的用户级别类型动态的写入IBAConfig，初始值均为黑色。
          只有“用户在线”的情况下才有效，同时，优先级将低于除“用户在线”外的其他状态颜色监控。
          用户设置界面的下拉也是动态生成的。

  4.自动退款
    描述：基本设置界面添加复选按钮选择（自动退款功能使能与否）和自动退款时间的设置编辑。
          自动退款功能使能标志和自动退款时间的设置写入IBAConfig，初始值分别为FLASE和30。
          条件：
	  1）只对临时用户有效且余额为零 。
	  2）包时，还在线，余额非0，会员的情况下均不退款注销。
          3）新开的卡，且余额为零者，不自动退款。
          符合自动退款条件者，不执行上网账号的激活，否则，激活并发声。

  5.重复打印
    描述：充值退款、包时、开户界面添加“重复打印”按钮，且默认按钮隐形。
          “重复打印”按钮显示有效条件：
          1）分别点击“开户”|“充值”|“包时”/“提前包时”后按钮出现，修改上网账号、重新查询时消失。
          2）“重复打印”所打印对象为最近一次确定性操作，修改数据未完成确定前所打印仍为上一次的数据。
	  3）必须在“打印小票”打钩作为必要条件，而且点击“开户”|“充值”|“包时”/“提前包时”后才点击打钩，
	“重复打印”也可出现。

  6.增加对网盾功能的支持。

  7.收银员操作查询添加“用户升级查询”及“充值卡充值查询”,在程序启动前动态载入/生成memberupgrade表。

  8.增加了统计普通用户以及会员用户的数目监控，在状态栏显示。
    描述：只有“用户在线”的时候才纳入统计的范畴。
          需要留心的是，这里的“会员用户”是除“普通用户”之外的所有用户。

**************************
*        V8.0.1.1        *
**************************
2010-5-17
  1.再次调整了冲正，充值卡充值，修改密码，修改资料，包时，用户升级的界面布局。

  2.冲正，充值卡充值，修改密码，修改资料，包时，用户升级等的界面的扫描证件基类进行修改。

**************************
*        V8.0.1.0        *
**************************
2010-5-13
  1.增加对ID读卡器的支持。在IBA.INI文件[IBA]段增加UseOurReader，不为0表示使用读卡器，为0则不使用，默认为不使用。

  2.调整了冲正，充值卡充值，修改密码，修改资料，包时，用户升级的界面布局。

  3.开户界面增加临时用户勾选框，需要中心配置参数gintTempMember=1才会出现。

**************************
*        V8.0.0.9        *
**************************
2010-5-6
  1.增加便捷通道：

	上网账号                       (激活该账号并显示充值退款界面)
	\终端号                        (在机器列表中选中所查找的终端)
	\\IP                           (在机器列表中选中根据IP所查找到的终端)
	?上网账号                      (在机器列表中选中根据上网账号所查找到的终端)
	+上网账号 金额                 (给指定的上网账号充值，金额单位为元)


  2.进销存增加积分兑换功能，修改了进销存查询模块和上下班盘点模块。

  3.更改账号后激活用户。

**************************
*        V8.0.0.8        *
**************************
2010-4-30
  1.增加IBA自动升级功能，需要在IBABin加入NBX.exe程序，IBA会自动写NBX.ini。

2010-4-29
  1.使用该版本IBA，请确保网吧中心配置好对应的实名类型。

  2.增加对网盾实名的支持，支持网盾刷卡，扫描仪，以及上传证件照和人身照。（中心要配置为网盾实名和SFREG参数为2或3）。

  3.在充值退款界面，用户资料显示用户包时信息。如果用户不在线，则在最下面显示完整的用户包时信息。

  4.在终端列表里面，选中在线用户双击鼠标或按回车键将显示充值退款界面。
 
  5.增加L2CameraU.dll，放在IBABin目录下面。该动态库主要是控制摄像头，没有该动态库，程序无法运行。

**************************
*        V8.0.0.7        *
**************************
2010-4-27
  1.对实名代码模块做了较大的调整，要测试刷卡是否正常。
  
  2.对采用任子行实名的激活做了限制，如果任子行激活激活失败，则不到我们的中心激活。（江门实名要求）

2010-4-22
  1.修正连续两次刷卡导致充值窗口失去焦点的问题（ESC无法关闭）。

2010-4-20
  1.当中心启用强制扫描后，IBA开户时不再强制验证身份证的有效性。

主要是因为顾虑王发行实名卡不严格，没有验证身份证的有效性，刷卡把资料传给IBA，如
果IBA强制验证身份证的有效性，将导致无法开户。

**************************
*        V8.0.0.6        *
**************************
2010-4-19
  1.修改进销存商品零售价采用中心建议零售价的BUG，应该使用中心实际的零售价格。

2010-4-16
  1.增加语音播报功能。采用微软的TTS技术，所以需要安装中文TTS语音包。

2010-4-15
  1.修正收银员操作查询中，一个开户操作可能会查询到多条开户记录的问题。（原因是数据库查询语句表关联条件不够严谨。）

2010-4-14
  1.修正选择商品时没有根据仓库顾虑的BUG.

  2.增加对下机后监控上面仍显示用户资料的用户进行下机支持。

  3.过滤掉对包时用户余额不足的判断。

2010-4-12
  1.增加对过滤王刷卡的支持，需要使用SunlikeAuditProxy 2.0.1.0 版本。

**************************
*        V8.0.0.5        *
**************************
2010-4-9
  1.增加中心进销存模块。


**************************
*        V8.0.0.1        *
**************************
2010-2-8
初始版本